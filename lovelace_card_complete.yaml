type: vertical-stack
cards:
  - type: custom:mushroom-title-card
    title: Pioneer AVR
    subtitle: Amplificateur Audio/Vid√©o
  - type: horizontal-stack
    cards:
      - type: custom:mushroom-entity-card
        entity: media_player.pioneer_avr
        name: Alimentation
        icon: mdi:power
        tap_action:
          action: toggle
        hold_action:
          action: more-info
        card_mod:
          style: |
            ha-card {
              background: linear-gradient(135deg, #1e293b 0%, #334155 100%);
              border-radius: 20px;
              box-shadow: 0 8px 16px rgba(0,0,0,0.3);
            }
      - type: custom:mushroom-template-card
        primary: "{{ states('media_player.pioneer_avr') | title }}"
        secondary: >-
          {{ state_attr('media_player.pioneer_avr', 'source') | default('Aucune source') }}
        icon: mdi:speaker
        icon_color: |
          {% if is_state('media_player.pioneer_avr', 'on') %}
            green
          {% else %}
            red
          {% endif %}
        card_mod:
          style: |
            ha-card {
              background: linear-gradient(135deg, #1e293b 0%, #334155 100%);
              border-radius: 20px;
              box-shadow: 0 8px 16px rgba(0,0,0,0.3);
            }
  - type: custom:mushroom-media-player-card
    entity: media_player.pioneer_avr
    use_media_info: false
    use_media_artwork: false
    show_volume_level: true
    volume_controls:
      - volume_mute
      - volume_set
      - volume_buttons
    card_mod:
      style: |
        ha-card {
          background: linear-gradient(135deg, #1e293b 0%, #334155 100%);
          border-radius: 20px;
          box-shadow: 0 8px 16px rgba(0,0,0,0.3);
          padding: 16px;
        }
  - type: custom:mushroom-title-card
    title: üéµ Sources Audio
  - type: grid
    columns: 5
    square: false
    cards:
      - type: custom:button-card
        entity: media_player.pioneer_avr
        name: CD
        icon: mdi:disc-player
        tap_action:
          action: call-service
          service: media_player.select_source
          service_data:
            entity_id: media_player.pioneer_avr
            source: CD
        state:
          - operator: template
            value: |
              [[[
                return states['media_player.pioneer_avr'].attributes.source === 'CD';
              ]]]
            styles:
              card:
                - background: "linear-gradient(135deg, #a855f7 0%, #ec4899 100%)"
                - box-shadow: 0 8px 16px rgba(168, 85, 247, 0.4)
                - transform: scale(1.05)
        styles:
          card:
            - background: "linear-gradient(135deg, #475569 0%, #334155 100%)"
            - border-radius: 20px
            - transition: all 0.3s ease
          name:
            - color: white
            - font-weight: bold
            - font-size: 14px
          icon:
            - color: white
            - width: 32px
      - type: custom:button-card
        entity: media_player.pioneer_avr
        name: Tuner
        icon: mdi:radio
        tap_action:
          action: call-service
          service: media_player.select_source
          service_data:
            entity_id: media_player.pioneer_avr
            source: Tuner
        state:
          - operator: template
            value: |
              [[[
                return states['media_player.pioneer_avr'].attributes.source === 'Tuner';
              ]]]
            styles:
              card:
                - background: "linear-gradient(135deg, #eab308 0%, #f97316 100%)"
                - box-shadow: 0 8px 16px rgba(234, 179, 8, 0.4)
                - transform: scale(1.05)
        styles:
          card:
            - background: "linear-gradient(135deg, #475569 0%, #334155 100%)"
            - border-radius: 20px
            - transition: all 0.3s ease
          name:
            - color: white
            - font-weight: bold
            - font-size: 14px
          icon:
            - color: white
            - width: 32px
      - type: custom:button-card
        entity: media_player.pioneer_avr
        name: Phono
        icon: mdi:album
        tap_action:
          action: call-service
          service: media_player.select_source
          service_data:
            entity_id: media_player.pioneer_avr
            source: Phono
        state:
          - operator: template
            value: |
              [[[
                return states['media_player.pioneer_avr'].attributes.source === 'Phono';
              ]]]
            styles:
              card:
                - background: "linear-gradient(135deg, #f43f5e 0%, #dc2626 100%)"
                - box-shadow: 0 8px 16px rgba(244, 63, 94, 0.4)
                - transform: scale(1.05)
        styles:
          card:
            - background: "linear-gradient(135deg, #475569 0%, #334155 100%)"
            - border-radius: 20px
            - transition: all 0.3s ease
          name:
            - color: white
            - font-weight: bold
            - font-size: 14px
          icon:
            - color: white
            - width: 32px
      - type: custom:button-card
        entity: media_player.pioneer_avr
        name: iPod/USB
        icon: mdi:usb
        tap_action:
          action: call-service
          service: media_player.select_source
          service_data:
            entity_id: media_player.pioneer_avr
            source: iPod/USB
        state:
          - operator: template
            value: |
              [[[
                return states['media_player.pioneer_avr'].attributes.source === 'iPod/USB';
              ]]]
            styles:
              card:
                - background: "linear-gradient(135deg, #8b5cf6 0%, #a855f7 100%)"
                - box-shadow: 0 8px 16px rgba(139, 92, 246, 0.4)
                - transform: scale(1.05)
        styles:
          card:
            - background: "linear-gradient(135deg, #475569 0%, #334155 100%)"
            - border-radius: 20px
            - transition: all 0.3s ease
          name:
            - color: white
            - font-weight: bold
            - font-size: 14px
          icon:
            - color: white
            - width: 32px
      - type: custom:button-card
        entity: media_player.pioneer_avr
        name: Bluetooth
        icon: mdi:bluetooth
        tap_action:
          action: call-service
          service: media_player.select_source
          service_data:
            entity_id: media_player.pioneer_avr
            source: Bluetooth
        state:
          - operator: template
            value: |
              [[[
                return states['media_player.pioneer_avr'].attributes.source === 'Bluetooth';
              ]]]
            styles:
              card:
                - background: "linear-gradient(135deg, #06b6d4 0%, #3b82f6 100%)"
                - box-shadow: 0 8px 16px rgba(6, 182, 212, 0.4)
                - transform: scale(1.05)
        styles:
          card:
            - background: "linear-gradient(135deg, #475569 0%, #334155 100%)"
            - border-radius: 20px
            - transition: all 0.3s ease
          name:
            - color: white
            - font-weight: bold
            - font-size: 14px
          icon:
            - color: white
            - width: 32px  - type: vertical-stack
    cards:
      - type: custom:mushroom-title-card
        title: üìª Stations FM
        subtitle: >
          ‚ö†Ô∏è IMPORTANT: La source doit √™tre sur TUNER pour utiliser les presets
          (01TP-08TP),  la navigation (TPD/TPI) et les fr√©quences (TFI/TFD).
          Sinon erreur E04.
      - type: grid
        columns: 4
        square: false
        cards:
          - type: custom:button-card
            entity: media_player.pioneer_avr
            name: Preset 1
            icon: mdi:numeric-1-circle
            tap_action:
              action: call-service
              service: pioneer_avr_lx83.send_raw_command
              service_data:
                entity_id: media_player.pioneer_avr
                command: 01TP
            state:
              - operator: template
                value: |
                  [[[
                    return states['media_player.pioneer_avr'].attributes.source === 'Tuner';
                  ]]]
                styles:
                  card:
                    - background: "linear-gradient(135deg, #f59e0b 0%, #f97316 100%)"
                    - opacity: 1
              - operator: template
                value: |
                  [[[
                    return states['media_player.pioneer_avr'].attributes.source !== 'Tuner';
                  ]]]
                styles:
                  card:
                    - background: "linear-gradient(135deg, #475569 0%, #334155 100%)"
                    - opacity: 0.5
                    - cursor: not-allowed
            styles:
              card:
                - border-radius: 16px
                - transition: all 0.3s ease
                - box-shadow: 0 4px 8px rgba(245, 158, 11, 0.3)
              name:
                - color: white
                - font-weight: bold
                - font-size: 13px
              icon:
                - color: white
                - width: 28px
          - type: custom:button-card
            entity: media_player.pioneer_avr
            name: Preset 2
            icon: mdi:numeric-2-circle
            tap_action:
              action: call-service
              service: pioneer_avr_lx83.send_raw_command
              service_data:
                entity_id: media_player.pioneer_avr
                command: 02TP
            state:
              - operator: template
                value: |
                  [[[
                    return states['media_player.pioneer_avr'].attributes.source === 'Tuner';
                  ]]]
                styles:
                  card:
                    - background: "linear-gradient(135deg, #f59e0b 0%, #f97316 100%)"
                    - opacity: 1
              - operator: template
                value: |
                  [[[
                    return states['media_player.pioneer_avr'].attributes.source !== 'Tuner';
                  ]]]
                styles:
                  card:
                    - background: "linear-gradient(135deg, #475569 0%, #334155 100%)"
                    - opacity: 0.5
                    - cursor: not-allowed
            styles:
              card:
                - border-radius: 16px
                - transition: all 0.3s ease
                - box-shadow: 0 4px 8px rgba(245, 158, 11, 0.3)
              name:
                - color: white
                - font-weight: bold
                - font-size: 13px
              icon:
                - color: white
                - width: 28px
          - type: custom:button-card
            entity: media_player.pioneer_avr
            name: Preset 3
            icon: mdi:numeric-3-circle
            tap_action:
              action: call-service
              service: pioneer_avr_lx83.send_raw_command
              service_data:
                entity_id: media_player.pioneer_avr
                command: 03TP
            state:
              - operator: template
                value: |
                  [[[
                    return states['media_player.pioneer_avr'].attributes.source === 'Tuner';
                  ]]]
                styles:
                  card:
                    - opacity: 1
              - operator: template
                value: |
                  [[[
                    return states['media_player.pioneer_avr'].attributes.source !== 'Tuner';
                  ]]]
                styles:
                  card:
                    - background: "linear-gradient(135deg, #475569 0%, #334155 100%)"
                    - opacity: 0.5
                    - cursor: not-allowed
            styles:
              card:
                - background: "linear-gradient(135deg, #f59e0b 0%, #f97316 100%)"
                - border-radius: 16px
                - transition: all 0.3s ease
                - box-shadow: 0 4px 8px rgba(245, 158, 11, 0.3)
              name:
                - color: white
                - font-weight: bold
                - font-size: 13px
              icon:
                - color: white
                - width: 28px
          - type: custom:button-card
            entity: media_player.pioneer_avr
            name: Preset 4
            icon: mdi:numeric-4-circle
            tap_action:
              action: call-service
              service: pioneer_avr_lx83.send_raw_command
              service_data:
                entity_id: media_player.pioneer_avr
                command: 04TP
            state:
              - operator: template
                value: |
                  [[[
                    return states['media_player.pioneer_avr'].attributes.source === 'Tuner';
                  ]]]
                styles:
                  card:
                    - opacity: 1
              - operator: template
                value: |
                  [[[
                    return states['media_player.pioneer_avr'].attributes.source !== 'Tuner';
                  ]]]
                styles:
                  card:
                    - background: "linear-gradient(135deg, #475569 0%, #334155 100%)"
                    - opacity: 0.5
                    - cursor: not-allowed
            styles:
              card:
                - background: "linear-gradient(135deg, #f59e0b 0%, #f97316 100%)"
                - border-radius: 16px
                - transition: all 0.3s ease
                - box-shadow: 0 4px 8px rgba(245, 158, 11, 0.3)
              name:
                - color: white
                - font-weight: bold
                - font-size: 13px
              icon:
                - color: white
                - width: 28px
          - type: custom:button-card
            entity: media_player.pioneer_avr
            name: Preset 5
            icon: mdi:numeric-5-circle
            tap_action:
              action: call-service
              service: pioneer_avr_lx83.send_raw_command
              service_data:
                entity_id: media_player.pioneer_avr
                command: 05TP
            state:
              - operator: template
                value: |
                  [[[
                    return states['media_player.pioneer_avr'].attributes.source === 'Tuner';
                  ]]]
                styles:
                  card:
                    - opacity: 1
              - operator: template
                value: |
                  [[[
                    return states['media_player.pioneer_avr'].attributes.source !== 'Tuner';
                  ]]]
                styles:
                  card:
                    - background: "linear-gradient(135deg, #475569 0%, #334155 100%)"
                    - opacity: 0.5
                    - cursor: not-allowed
            styles:
              card:
                - background: "linear-gradient(135deg, #10b981 0%, #059669 100%)"
                - border-radius: 16px
                - transition: all 0.3s ease
                - box-shadow: 0 4px 8px rgba(16, 185, 129, 0.3)
              name:
                - color: white
                - font-weight: bold
                - font-size: 13px
              icon:
                - color: white
                - width: 28px
          - type: custom:button-card
            entity: media_player.pioneer_avr
            name: Preset 6
            icon: mdi:numeric-6-circle
            tap_action:
              action: call-service
              service: pioneer_avr_lx83.send_raw_command
              service_data:
                entity_id: media_player.pioneer_avr
                command: 06TP
            state:
              - operator: template
                value: |
                  [[[
                    return states['media_player.pioneer_avr'].attributes.source === 'Tuner';
                  ]]]
                styles:
                  card:
                    - opacity: 1
              - operator: template
                value: |
                  [[[
                    return states['media_player.pioneer_avr'].attributes.source !== 'Tuner';
                  ]]]
                styles:
                  card:
                    - background: "linear-gradient(135deg, #475569 0%, #334155 100%)"
                    - opacity: 0.5
                    - cursor: not-allowed
            styles:
              card:
                - background: "linear-gradient(135deg, #10b981 0%, #059669 100%)"
                - border-radius: 16px
                - transition: all 0.3s ease
                - box-shadow: 0 4px 8px rgba(16, 185, 129, 0.3)
              name:
                - color: white
                - font-weight: bold
                - font-size: 13px
              icon:
                - color: white
                - width: 28px
          - type: custom:button-card
            entity: media_player.pioneer_avr
            name: Preset 7
            icon: mdi:numeric-7-circle
            tap_action:
              action: call-service
              service: pioneer_avr_lx83.send_raw_command
              service_data:
                entity_id: media_player.pioneer_avr
                command: 07TP
            state:
              - operator: template
                value: |
                  [[[
                    return states['media_player.pioneer_avr'].attributes.source === 'Tuner';
                  ]]]
                styles:
                  card:
                    - opacity: 1
              - operator: template
                value: |
                  [[[
                    return states['media_player.pioneer_avr'].attributes.source !== 'Tuner';
                  ]]]
                styles:
                  card:
                    - background: "linear-gradient(135deg, #475569 0%, #334155 100%)"
                    - opacity: 0.5
                    - cursor: not-allowed
            styles:
              card:
                - background: "linear-gradient(135deg, #10b981 0%, #059669 100%)"
                - border-radius: 16px
                - transition: all 0.3s ease
                - box-shadow: 0 4px 8px rgba(16, 185, 129, 0.3)
              name:
                - color: white
                - font-weight: bold
                - font-size: 13px
              icon:
                - color: white
                - width: 28px
          - type: custom:button-card
            entity: media_player.pioneer_avr
            name: Preset 8
            icon: mdi:numeric-8-circle
            tap_action:
              action: call-service
              service: pioneer_avr_lx83.send_raw_command
              service_data:
                entity_id: media_player.pioneer_avr
                command: 08TP
            state:
              - operator: template
                value: |
                  [[[
                    return states['media_player.pioneer_avr'].attributes.source === 'Tuner';
                  ]]]
                styles:
                  card:
                    - opacity: 1
              - operator: template
                value: |
                  [[[
                    return states['media_player.pioneer_avr'].attributes.source !== 'Tuner';
                  ]]]
                styles:
                  card:
                    - background: "linear-gradient(135deg, #475569 0%, #334155 100%)"
                    - opacity: 0.5
                    - cursor: not-allowed
            styles:
              card:
                - background: "linear-gradient(135deg, #10b981 0%, #059669 100%)"
                - border-radius: 16px
                - transition: all 0.3s ease
                - box-shadow: 0 4px 8px rgba(16, 185, 129, 0.3)
              name:
                - color: white
                - font-weight: bold
                - font-size: 13px
              icon:
                - color: white
                - width: 28px
      - type: horizontal-stack
        cards:
          - type: custom:button-card
            entity: media_player.pioneer_avr
            name: ‚óÄ Pr√©c√©dent
            icon: mdi:skip-previous
            tap_action:
              action: call-service
              service: pioneer_avr_lx83.send_raw_command
              service_data:
                entity_id: media_player.pioneer_avr
                command: TPD
            state:
              - operator: template
                value: |
                  [[[
                    return states['media_player.pioneer_avr'].attributes.source === 'Tuner';
                  ]]]
                styles:
                  card:
                    - opacity: 1
              - operator: template
                value: |
                  [[[
                    return states['media_player.pioneer_avr'].attributes.source !== 'Tuner';
                  ]]]
                styles:
                  card:
                    - background: "linear-gradient(135deg, #475569 0%, #334155 100%)"
                    - opacity: 0.5
                    - cursor: not-allowed
            styles:
              card:
                - background: "linear-gradient(135deg, #3b82f6 0%, #2563eb 100%)"
                - border-radius: 16px
                - padding: 12px
              name:
                - color: white
                - font-weight: bold
              icon:
                - color: white
                - width: 28px
          - type: custom:button-card
            entity: media_player.pioneer_avr
            name: Suivant ‚ñ∂
            icon: mdi:skip-next
            tap_action:
              action: call-service
              service: pioneer_avr_lx83.send_raw_command
              service_data:
                entity_id: media_player.pioneer_avr
                command: TPI
            state:
              - operator: template
                value: |
                  [[[
                    return states['media_player.pioneer_avr'].attributes.source === 'Tuner';
                  ]]]
                styles:
                  card:
                    - opacity: 1
              - operator: template
                value: |
                  [[[
                    return states['media_player.pioneer_avr'].attributes.source !== 'Tuner';
                  ]]]
                styles:
                  card:
                    - background: "linear-gradient(135deg, #475569 0%, #334155 100%)"
                    - opacity: 0.5
                    - cursor: not-allowed
            styles:
              card:
                - background: "linear-gradient(135deg, #3b82f6 0%, #2563eb 100%)"
                - border-radius: 16px
                - padding: 12px
              name:
                - color: white
                - font-weight: bold
              icon:
                - color: white
                - width: 28px
      - type: horizontal-stack
        cards:
          - type: custom:button-card
            entity: media_player.pioneer_avr
            name: Fr√©quence +
            icon: mdi:arrow-up
            tap_action:
              action: call-service
              service: pioneer_avr_lx83.send_raw_command
              service_data:
                entity_id: media_player.pioneer_avr
                command: TFI
            state:
              - operator: template
                value: |
                  [[[
                    return states['media_player.pioneer_avr'].attributes.source === 'Tuner';
                  ]]]
                styles:
                  card:
                    - opacity: 1
              - operator: template
                value: |
                  [[[
                    return states['media_player.pioneer_avr'].attributes.source !== 'Tuner';
                  ]]]
                styles:
                  card:
                    - background: "linear-gradient(135deg, #475569 0%, #334155 100%)"
                    - opacity: 0.5
                    - cursor: not-allowed
            styles:
              card:
                - background: "linear-gradient(135deg, #8b5cf6 0%, #a855f7 100%)"
                - border-radius: 16px
                - padding: 12px
              name:
                - color: white
                - font-weight: bold
              icon:
                - color: white
                - width: 28px
          - type: custom:button-card
            entity: media_player.pioneer_avr
            name: Fr√©quence -
            icon: mdi:arrow-down
            tap_action:
              action: call-service
              service: pioneer_avr_lx83.send_raw_command
              service_data:
                entity_id: media_player.pioneer_avr
                command: TFD
            state:
              - operator: template
                value: |
                  [[[
                    return states['media_player.pioneer_avr'].attributes.source === 'Tuner';
                  ]]]
                styles:
                  card:
                    - opacity: 1
              - operator: template
                value: |
                  [[[
                    return states['media_player.pioneer_avr'].attributes.source !== 'Tuner';
                  ]]]
                styles:
                  card:
                    - background: "linear-gradient(135deg, #475569 0%, #334155 100%)"
                    - opacity: 0.5
                    - cursor: not-allowed
            styles:
              card:
                - background: "linear-gradient(135deg, #8b5cf6 0%, #a855f7 100%)"
                - border-radius: 16px
                - padding: 12px
              name:
                - color: white
                - font-weight: bold
              icon:
                - color: white
                - width: 28px
  - type: custom:mushroom-title-card
    title: üì∫ Sources Vid√©o
  - type: grid
    columns: 3
    square: false
    cards:
      - type: custom:button-card
        entity: media_player.pioneer_avr
        name: DVD
        icon: mdi:disc
        tap_action:
          action: call-service
          service: media_player.select_source
          service_data:
            entity_id: media_player.pioneer_avr
            source: DVD
        state:
          - operator: template
            value: |
              [[[
                return states['media_player.pioneer_avr'].attributes.source === 'DVD';
              ]]]
            styles:
              card:
                - background: "linear-gradient(135deg, #3b82f6 0%, #06b6d4 100%)"
                - box-shadow: 0 8px 16px rgba(59, 130, 246, 0.4)
                - transform: scale(1.05)
        styles:
          card:
            - background: "linear-gradient(135deg, #475569 0%, #334155 100%)"
            - border-radius: 20px
            - transition: all 0.3s ease
          name:
            - color: white
            - font-weight: bold
            - font-size: 14px
          icon:
            - color: white
            - width: 32px
      - type: custom:button-card
        entity: media_player.pioneer_avr
        name: BD
        icon: mdi:disc
        tap_action:
          action: call-service
          service: media_player.select_source
          service_data:
            entity_id: media_player.pioneer_avr
            source: BD
        state:
          - operator: template
            value: |
              [[[
                var source = states['media_player.pioneer_avr'].attributes.source;
                console.log('Current source:', source);
                return source === 'BD' || source === 'Blu-ray' || source === 'BluRay';
              ]]]
            styles:
              card:
                - background: "linear-gradient(135deg, #6366f1 0%, #3b82f6 100%)"
                - box-shadow: 0 8px 16px rgba(99, 102, 241, 0.4)
                - transform: scale(1.05)
        styles:
          card:
            - background: "linear-gradient(135deg, #475569 0%, #334155 100%)"
            - border-radius: 20px
            - transition: all 0.3s ease
          name:
            - color: white
            - font-weight: bold
            - font-size: 14px
          icon:
            - color: white
            - width: 32px
      - type: custom:button-card
        entity: media_player.pioneer_avr
        name: TV/Sat
        icon: mdi:television
        tap_action:
          action: call-service
          service: media_player.select_source
          service_data:
            entity_id: media_player.pioneer_avr
            source: TV/Sat
        state:
          - operator: template
            value: |
              [[[
                return states['media_player.pioneer_avr'].attributes.source === 'TV/Sat';
              ]]]
            styles:
              card:
                - background: "linear-gradient(135deg, #f97316 0%, #dc2626 100%)"
                - box-shadow: 0 8px 16px rgba(249, 115, 22, 0.4)
                - transform: scale(1.05)
        styles:
          card:
            - background: "linear-gradient(135deg, #475569 0%, #334155 100%)"
            - border-radius: 20px
            - transition: all 0.3s ease
          name:
            - color: white
            - font-weight: bold
            - font-size: 14px
          icon:
            - color: white
            - width: 32px  - type: custom:mushroom-title-card
    title: üéß Modes Audio
  - type: custom:mushroom-title-card
    title: Modes de base
    subtitle: Modes audio fondamentaux
  - type: grid
    columns: 3
    square: false
    cards:
      - type: custom:button-card
        entity: media_player.pioneer_avr
        name: St√©r√©o
        icon: mdi:speaker-multiple
        tap_action:
          action: call-service
          service: pioneer_avr_lx83.send_raw_command
          service_data:
            entity_id: media_player.pioneer_avr
            command: 0001SR
        state:
          - operator: template
            value: |
              [[[
                var mode = states['media_player.pioneer_avr'].attributes.sound_mode;
                if (!mode) return false;
                var modeLower = mode.toLowerCase();
                return modeLower === 'stereo' || modeLower.includes('stereo');
              ]]]
            styles:
              card:
                - background: "linear-gradient(135deg, #10b981 0%, #059669 100%)"
                - box-shadow: 0 8px 16px rgba(16, 185, 129, 0.4)
                - transform: scale(1.05)
        styles:
          card:
            - background: "linear-gradient(135deg, #475569 0%, #334155 100%)"
            - border-radius: 20px
            - transition: all 0.3s ease
          name:
            - color: white
            - font-weight: bold
            - font-size: 14px
          icon:
            - color: white
            - width: 32px
      - type: custom:button-card
        entity: media_player.pioneer_avr
        name: Auto Surround
        icon: mdi:surround-sound
        tap_action:
          action: call-service
          service: pioneer_avr_lx83.send_raw_command
          service_data:
            entity_id: media_player.pioneer_avr
            command: 0006SR
        state:
          - operator: template
            value: |
              [[[
                var mode = states['media_player.pioneer_avr'].attributes.sound_mode;
                if (!mode) return false;
                var modeLower = mode.toLowerCase();
                return modeLower === 'auto surround' || modeLower.includes('auto surround') || modeLower.includes('auto');
              ]]]
            styles:
              card:
                - background: "linear-gradient(135deg, #8b5cf6 0%, #a855f7 100%)"
                - box-shadow: 0 8px 16px rgba(139, 92, 246, 0.4)
                - transform: scale(1.05)
        styles:
          card:
            - background: "linear-gradient(135deg, #475569 0%, #334155 100%)"
            - border-radius: 20px
            - transition: all 0.3s ease
          name:
            - color: white
            - font-weight: bold
            - font-size: 13px
          icon:
            - color: white
            - width: 32px
      - type: custom:button-card
        entity: media_player.pioneer_avr
        name: Direct
        icon: mdi:volume-high
        tap_action:
          action: call-service
          service: pioneer_avr_lx83.send_raw_command
          service_data:
            entity_id: media_player.pioneer_avr
            command: 0007SR
        state:
          - operator: template
            value: |
              [[[
                var mode = states['media_player.pioneer_avr'].attributes.sound_mode;
                if (!mode) return false;
                var modeLower = mode.toLowerCase().trim();
                // Direct doit √™tre exactement "direct" et ne pas contenir "pure"
                return modeLower === 'direct' && !modeLower.includes('pure');
              ]]]
            styles:
              card:
                - background: "linear-gradient(135deg, #06b6d4 0%, #3b82f6 100%)"
                - box-shadow: 0 8px 16px rgba(6, 182, 212, 0.4)
                - transform: scale(1.05)
        styles:
          card:
            - background: "linear-gradient(135deg, #475569 0%, #334155 100%)"
            - border-radius: 20px
            - transition: all 0.3s ease
          name:
            - color: white
            - font-weight: bold
            - font-size: 14px
          icon:
            - color: white
            - width: 32px
      - type: custom:button-card
        entity: media_player.pioneer_avr
        name: Pure Direct
        icon: mdi:music-circle
        tap_action:
          action: call-service
          service: pioneer_avr_lx83.send_raw_command
          service_data:
            entity_id: media_player.pioneer_avr
            command: 0008SR
        state:
          - operator: template
            value: |
              [[[
                var mode = states['media_player.pioneer_avr'].attributes.sound_mode;
                if (!mode) return false;
                var modeLower = mode.toLowerCase().trim();
                // Pure Direct doit contenir "pure" ET "direct"
                return modeLower.includes('pure') && modeLower.includes('direct');
              ]]]
            styles:
              card:
                - background: "linear-gradient(135deg, #f59e0b 0%, #f97316 100%)"
                - box-shadow: 0 8px 16px rgba(245, 158, 11, 0.4)
                - transform: scale(1.05)
        styles:
          card:
            - background: "linear-gradient(135deg, #475569 0%, #334155 100%)"
            - border-radius: 20px
            - transition: all 0.3s ease
          name:
            - color: white
            - font-weight: bold
            - font-size: 13px
          icon:
            - color: white
            - width: 32px
      - type: custom:button-card
        entity: media_player.pioneer_avr
        name: Advanced Game
        icon: mdi:gamepad-variant
        tap_action:
          action: call-service
          service: pioneer_avr_lx83.send_raw_command
          service_data:
            entity_id: media_player.pioneer_avr
            command: 0118SR
        state:
          - operator: template
            value: |
              [[[
                var mode = states['media_player.pioneer_avr'].attributes.sound_mode;
                if (!mode) return false;
                var modeLower = mode.toLowerCase().trim();
                // Advanced Game doit contenir "game" ou "advanced game"
                return modeLower === 'advanced game' || (modeLower.includes('game') && modeLower.includes('advanced'));
              ]]]
            styles:
              card:
                - background: "linear-gradient(135deg, #ec4899 0%, #db2777 100%)"
                - box-shadow: 0 8px 16px rgba(236, 72, 153, 0.4)
                - transform: scale(1.05)
        styles:
          card:
            - background: "linear-gradient(135deg, #475569 0%, #334155 100%)"
            - border-radius: 20px
            - transition: all 0.3s ease
          name:
            - color: white
            - font-weight: bold
            - font-size: 12px
          icon:
            - color: white
            - width: 32px
      - type: custom:button-card
        entity: media_player.pioneer_avr
        name: Extended Stereo
        icon: mdi:speaker-wireless
        tap_action:
          action: call-service
          service: pioneer_avr_lx83.send_raw_command
          service_data:
            entity_id: media_player.pioneer_avr
            command: 0112SR
        state:
          - operator: template
            value: |
              [[[
                var mode = states['media_player.pioneer_avr'].attributes.sound_mode;
                var modeCode = states['media_player.pioneer_avr'].attributes.sound_mode_code;
                if (!mode && !modeCode) return false;
                var modeLower = mode ? mode.toLowerCase().trim() : '';
                var nameMatch = modeLower.includes('extended') && modeLower.includes('stereo');
                var codeMatch = modeCode && String(modeCode).trim() === '0112';
                return nameMatch || codeMatch;
              ]]]
            styles:
              card:
                - background: "linear-gradient(135deg, #6366f1 0%, #4f46e5 100%)"
                - box-shadow: 0 8px 16px rgba(99, 102, 241, 0.4)
                - transform: scale(1.05)
        styles:
          card:
            - background: "linear-gradient(135deg, #475569 0%, #334155 100%)"
            - border-radius: 20px
            - transition: all 0.3s ease
          name:
            - color: white
            - font-weight: bold
            - font-size: 14px
          icon:
            - color: white
            - width: 32px

  - type: custom:mushroom-title-card
    title: Modes Dolby Pro Logic
    subtitle: Modes Dolby et DTS
  - type: grid
    columns: 3
    square: false
    cards:
      - type: custom:button-card
        entity: media_player.pioneer_avr
        name: Cycle Dolby/DTS
        icon: mdi:sync
        tap_action:
          action: call-service
          service: pioneer_avr_lx83.send_raw_command
          service_data:
            entity_id: media_player.pioneer_avr
            command: 0010SR
        subtitle: |
          Appuyer plusieurs fois pour changer
        state:
          - operator: template
            value: |
              [[[
                var mode = states['media_player.pioneer_avr'].attributes.sound_mode;
                if (!mode) return false;
                var modeLower = mode.toLowerCase().trim();
                return modeLower.includes('pro logic') || modeLower.includes('neo:6') || modeLower.includes('neural');
              ]]]
            styles:
              card:
                - background: "linear-gradient(135deg, #8b5cf6 0%, #7c3aed 100%)"
                - box-shadow: 0 8px 16px rgba(139, 92, 246, 0.4)
                - transform: scale(1.05)
        styles:
          card:
            - background: "linear-gradient(135deg, #475569 0%, #334155 100%)"
            - border-radius: 20px
            - transition: all 0.3s ease
          name:
            - color: white
            - font-weight: bold
            - font-size: 14px
          icon:
            - color: white
            - width: 32px
      - type: custom:button-card
        entity: media_player.pioneer_avr
        name: PL II Movie
        icon: mdi:movie-open-outline
        tap_action:
          action: call-service
          service: pioneer_avr_lx83.send_raw_command
          service_data:
            entity_id: media_player.pioneer_avr
            command: 0013SR
        state:
          - operator: template
            value: |
              [[[
                var mode = states['media_player.pioneer_avr'].attributes.sound_mode;
                var modeCode = states['media_player.pioneer_avr'].attributes.sound_mode_code;
                if (!mode && !modeCode) return false;
                var modeLower = mode ? mode.toLowerCase().trim() : '';
                var nameMatch = modeLower.includes('pro logic') && modeLower.includes('movie');
                var codeMatch = modeCode && String(modeCode).trim() === '0102';
                return nameMatch || codeMatch;
              ]]]
            styles:
              card:
                - background: "linear-gradient(135deg, #8b5cf6 0%, #7c3aed 100%)"
                - box-shadow: 0 8px 16px rgba(139, 92, 246, 0.4)
                - transform: scale(1.05)
        styles:
          card:
            - background: "linear-gradient(135deg, #475569 0%, #334155 100%)"
            - border-radius: 20px
            - transition: all 0.3s ease
          name:
            - color: white
            - font-weight: bold
            - font-size: 12px
          icon:
            - color: white
            - width: 32px
      - type: custom:button-card
        entity: media_player.pioneer_avr
        name: PL II Music
        icon: mdi:music-note
        tap_action:
          action: call-service
          service: pioneer_avr_lx83.send_raw_command
          service_data:
            entity_id: media_player.pioneer_avr
            command: 0014SR
        state:
          - operator: template
            value: |
              [[[
                var mode = states['media_player.pioneer_avr'].attributes.sound_mode;
                var modeCode = states['media_player.pioneer_avr'].attributes.sound_mode_code;
                if (!mode && !modeCode) return false;
                var modeLower = mode ? mode.toLowerCase().trim() : '';
                var nameMatch = modeLower.includes('pro logic') && modeLower.includes('music');
                var codeMatch = modeCode && String(modeCode).trim() === '0104';
                return nameMatch || codeMatch;
              ]]]
            styles:
              card:
                - background: "linear-gradient(135deg, #a855f7 0%, #9333ea 100%)"
                - box-shadow: 0 8px 16px rgba(168, 85, 247, 0.4)
                - transform: scale(1.05)
        styles:
          card:
            - background: "linear-gradient(135deg, #475569 0%, #334155 100%)"
            - border-radius: 20px
            - transition: all 0.3s ease
          name:
            - color: white
            - font-weight: bold
            - font-size: 12px
          icon:
            - color: white
            - width: 32px
      - type: custom:button-card
        entity: media_player.pioneer_avr
        name: Dolby Surround
        icon: mdi:surround-sound-5-1
        tap_action:
          action: call-service
          service: pioneer_avr_lx83.send_raw_command
          service_data:
            entity_id: media_player.pioneer_avr
            command: 0151SR
        state:
          - operator: template
            value: |
              [[[
                var mode = states['media_player.pioneer_avr'].attributes.sound_mode;
                var modeCode = states['media_player.pioneer_avr'].attributes.sound_mode_code;
                if (!mode && !modeCode) return false;
                var modeLower = mode ? mode.toLowerCase().trim() : '';
                var nameMatch = modeLower.includes('dolby surround') || (modeLower.includes('dolby') && modeLower.includes('surround'));
                var codeMatch = modeCode && String(modeCode).trim() === '0151';
                return nameMatch || codeMatch;
              ]]]
            styles:
              card:
                - background: "linear-gradient(135deg, #06b6d4 0%, #0891b2 100%)"
                - box-shadow: 0 8px 16px rgba(6, 182, 212, 0.4)
                - transform: scale(1.05)
        styles:
          card:
            - background: "linear-gradient(135deg, #475569 0%, #334155 100%)"
            - border-radius: 20px
            - transition: all 0.3s ease
          name:
            - color: white
            - font-weight: bold
            - font-size: 13px
          icon:
            - color: white
            - width: 32px
      - type: custom:button-card
        entity: media_player.pioneer_avr
        name: Cycle Dolby+THX
        icon: mdi:sync-circle
        tap_action:
          action: call-service
          service: pioneer_avr_lx83.send_raw_command
          service_data:
            entity_id: media_player.pioneer_avr
            command: 0050SR
        subtitle: |
          Appuyer plusieurs fois pour changer
        state:
          - operator: template
            value: |
              [[[
                var mode = states['media_player.pioneer_avr'].attributes.sound_mode;
                var modeCode = states['media_player.pioneer_avr'].attributes.sound_mode_code;
                if (!mode && !modeCode) return false;
                var modeLower = mode ? mode.toLowerCase().trim() : '';
                var codeStr = modeCode ? String(modeCode).trim() : '';
                return codeStr.startsWith('03') && modeLower.includes('thx');
              ]]]
            styles:
              card:
                - background: "linear-gradient(135deg, #dc2626 0%, #991b1b 100%)"
                - box-shadow: 0 8px 16px rgba(220, 38, 38, 0.4)
                - transform: scale(1.05)
        styles:
          card:
            - background: "linear-gradient(135deg, #475569 0%, #334155 100%)"
            - border-radius: 20px
            - transition: all 0.3s ease
          name:
            - color: white
            - font-weight: bold
            - font-size: 12px
          icon:
            - color: white
            - width: 32px
      - type: custom:button-card
        entity: media_player.pioneer_avr
        name: Cycle DSP
        icon: mdi:equalizer
        tap_action:
          action: call-service
          service: pioneer_avr_lx83.send_raw_command
          service_data:
            entity_id: media_player.pioneer_avr
            command: 0100SR
        subtitle: |
          Classical, Rock, Action, etc.
        state:
          - operator: template
            value: |
              [[[
                var mode = states['media_player.pioneer_avr'].attributes.sound_mode;
                var modeCode = states['media_player.pioneer_avr'].attributes.sound_mode_code;
                if (!mode && !modeCode) return false;
                var modeLower = mode ? mode.toLowerCase().trim() : '';
                var codeStr = modeCode ? String(modeCode).trim() : '';
                return codeStr.startsWith('02') && 
                      (modeLower.includes('classical') || modeLower.includes('rock') || 
                       modeLower.includes('action') || modeLower.includes('drama') ||
                       modeLower.includes('sci-fi') || modeLower.includes('sports'));
              ]]]
            styles:
              card:
                - background: "linear-gradient(135deg, #f97316 0%, #ea580c 100%)"
                - box-shadow: 0 8px 16px rgba(249, 115, 22, 0.4)
                - transform: scale(1.05)
        styles:
          card:
            - background: "linear-gradient(135deg, #475569 0%, #334155 100%)"
            - border-radius: 20px
            - transition: all 0.3s ease
          name:
            - color: white
            - font-weight: bold
            - font-size: 12px
          icon:
            - color: white
            - width: 32px  - type: custom:mushroom-title-card
    title: Modes THX
    subtitle: Modes cin√©ma, musique et jeux THX
  - type: grid
    columns: 3
    square: false
    cards:
      - type: custom:button-card
        entity: media_player.pioneer_avr
        name: THX Cinema
        icon: mdi:movie-open
        tap_action:
          action: call-service
          service: pioneer_avr_lx83.send_raw_command
          service_data:
            entity_id: media_player.pioneer_avr
            command: 0101SR
        state:
          - operator: template
            value: |
              [[[
                var mode = states['media_player.pioneer_avr'].attributes.sound_mode;
                var modeCode = states['media_player.pioneer_avr'].attributes.sound_mode_code;
                if (!mode && !modeCode) return false;
                var modeLower = mode ? mode.toLowerCase().trim() : '';
                // V√©rifier par le nom
                var hasThx = modeLower.includes('thx');
                var hasCinema = modeLower.includes('cinema');
                var hasMusic = modeLower.includes('music');
                var nameMatch = hasThx && hasCinema && !hasMusic;
                // V√©rifier aussi par le code (0101 = THX Cinema - code correct)
                var codeMatch = false;
                if (modeCode) {
                  var codeStr = String(modeCode).trim();
                  // Code correct pour THX Cinema: 0101
                  // Accepter aussi les anciens codes pour compatibilit√©
                  codeMatch = codeStr === '0101' ||  // Code correct
                             codeStr === '0056';     // Ancien code (mapp√© vers 0101)
                }
                return nameMatch || codeMatch;
              ]]]
            styles:
              card:
                - background: "linear-gradient(135deg, #dc2626 0%, #991b1b 100%)"
                - box-shadow: 0 8px 16px rgba(220, 38, 38, 0.4)
                - transform: scale(1.05)
        styles:
          card:
            - background: "linear-gradient(135deg, #475569 0%, #334155 100%)"
            - border-radius: 20px
            - transition: all 0.3s ease
          name:
            - color: white
            - font-weight: bold
            - font-size: 13px
          icon:
            - color: white
            - width: 32px
      - type: custom:button-card
        entity: media_player.pioneer_avr
        name: THX Music
        icon: mdi:music-circle
        tap_action:
          action: call-service
          service: pioneer_avr_lx83.send_raw_command
          service_data:
            entity_id: media_player.pioneer_avr
            command: 0102SR
        state:
          - operator: template
            value: |
              [[[
                var mode = states['media_player.pioneer_avr'].attributes.sound_mode;
                var modeCode = states['media_player.pioneer_avr'].attributes.sound_mode_code;
                if (!mode && !modeCode) return false;
                var modeLower = mode ? mode.toLowerCase().trim() : '';
                var hasThx = modeLower.includes('thx');
                var hasMusic = modeLower.includes('music');
                var hasCinema = modeLower.includes('cinema');
                var nameMatch = hasThx && hasMusic && !hasCinema;
                var codeMatch = modeCode && String(modeCode).trim() === '0102';
                return nameMatch || codeMatch;
              ]]]
            styles:
              card:
                - background: "linear-gradient(135deg, #ec4899 0%, #db2777 100%)"
                - box-shadow: 0 8px 16px rgba(236, 72, 153, 0.4)
                - transform: scale(1.05)
        styles:
          card:
            - background: "linear-gradient(135deg, #475569 0%, #334155 100%)"
            - border-radius: 20px
            - transition: all 0.3s ease
          name:
            - color: white
            - font-weight: bold
            - font-size: 13px
          icon:
            - color: white
            - width: 32px
      - type: custom:button-card
        entity: media_player.pioneer_avr
        name: THX Games
        icon: mdi:gamepad
        tap_action:
          action: call-service
          service: pioneer_avr_lx83.send_raw_command
          service_data:
            entity_id: media_player.pioneer_avr
            command: 0103SR
        state:
          - operator: template
            value: |
              [[[
                var mode = states['media_player.pioneer_avr'].attributes.sound_mode;
                var modeCode = states['media_player.pioneer_avr'].attributes.sound_mode_code;
                if (!mode && !modeCode) return false;
                var modeLower = mode ? mode.toLowerCase().trim() : '';
                var hasThx = modeLower.includes('thx');
                var hasGames = modeLower.includes('games');
                var nameMatch = hasThx && hasGames;
                var codeMatch = modeCode && String(modeCode).trim() === '0103';
                return nameMatch || codeMatch;
              ]]]
            styles:
              card:
                - background: "linear-gradient(135deg, #f97316 0%, #ea580c 100%)"
                - box-shadow: 0 8px 16px rgba(249, 115, 22, 0.4)
                - transform: scale(1.05)
        styles:
          card:
            - background: "linear-gradient(135deg, #475569 0%, #334155 100%)"
            - border-radius: 20px
            - transition: all 0.3s ease
          name:
            - color: white
            - font-weight: bold
            - font-size: 13px
          icon:
            - color: white
            - width: 32px
      - type: custom:button-card
        entity: media_player.pioneer_avr
        name: THX Select2 Cinema
        icon: mdi:movie-open-star
        tap_action:
          action: call-service
          service: pioneer_avr_lx83.send_raw_command
          service_data:
            entity_id: media_player.pioneer_avr
            command: 0105SR
        state:
          - operator: template
            value: |
              [[[
                var mode = states['media_player.pioneer_avr'].attributes.sound_mode;
                var modeCode = states['media_player.pioneer_avr'].attributes.sound_mode_code;
                if (!mode && !modeCode) return false;
                var modeLower = mode ? mode.toLowerCase().trim() : '';
                var hasThx = modeLower.includes('thx');
                var hasSelect2 = modeLower.includes('select2') || modeLower.includes('ultra2');
                var hasCinema = modeLower.includes('cinema');
                var hasMusic = modeLower.includes('music');
                var hasGames = modeLower.includes('games');
                var nameMatch = hasThx && hasSelect2 && hasCinema && !hasMusic && !hasGames;
                var codeMatch = modeCode && (String(modeCode).trim() === '0105');
                return nameMatch || codeMatch;
              ]]]
            styles:
              card:
                - background: "linear-gradient(135deg, #be123c 0%, #9f1239 100%)"
                - box-shadow: 0 8px 16px rgba(190, 18, 60, 0.4)
                - transform: scale(1.05)
        styles:
          card:
            - background: "linear-gradient(135deg, #475569 0%, #334155 100%)"
            - border-radius: 20px
            - transition: all 0.3s ease
          name:
            - color: white
            - font-weight: bold
            - font-size: 11px
          icon:
            - color: white
            - width: 32px
      - type: custom:button-card
        entity: media_player.pioneer_avr
        name: THX Select2 Music
        icon: mdi:music-note-eighth
        tap_action:
          action: call-service
          service: pioneer_avr_lx83.send_raw_command
          service_data:
            entity_id: media_player.pioneer_avr
            command: 0106SR
        state:
          - operator: template
            value: |
              [[[
                var mode = states['media_player.pioneer_avr'].attributes.sound_mode;
                var modeCode = states['media_player.pioneer_avr'].attributes.sound_mode_code;
                if (!mode && !modeCode) return false;
                var modeLower = mode ? mode.toLowerCase().trim() : '';
                var hasThx = modeLower.includes('thx');
                var hasSelect2 = modeLower.includes('select2') || modeLower.includes('ultra2');
                var hasMusic = modeLower.includes('music');
                var hasCinema = modeLower.includes('cinema');
                var hasGames = modeLower.includes('games');
                var nameMatch = hasThx && hasSelect2 && hasMusic && !hasCinema && !hasGames;
                var codeMatch = modeCode && (String(modeCode).trim() === '0106');
                return nameMatch || codeMatch;
              ]]]
            styles:
              card:
                - background: "linear-gradient(135deg, #c026d3 0%, #a21caf 100%)"
                - box-shadow: 0 8px 16px rgba(192, 38, 211, 0.4)
                - transform: scale(1.05)
        styles:
          card:
            - background: "linear-gradient(135deg, #475569 0%, #334155 100%)"
            - border-radius: 20px
            - transition: all 0.3s ease
          name:
            - color: white
            - font-weight: bold
            - font-size: 11px
          icon:
            - color: white
            - width: 32px
      - type: custom:button-card
        entity: media_player.pioneer_avr
        name: THX Select2 Games
        icon: mdi:gamepad-circle
        tap_action:
          action: call-service
          service: pioneer_avr_lx83.send_raw_command
          service_data:
            entity_id: media_player.pioneer_avr
            command: 0107SR
        state:
          - operator: template
            value: |
              [[[
                var mode = states['media_player.pioneer_avr'].attributes.sound_mode;
                var modeCode = states['media_player.pioneer_avr'].attributes.sound_mode_code;
                if (!mode && !modeCode) return false;
                var modeLower = mode ? mode.toLowerCase().trim() : '';
                var hasThx = modeLower.includes('thx');
                var hasSelect2 = modeLower.includes('select2') || modeLower.includes('ultra2');
                var hasGames = modeLower.includes('games');
                var hasCinema = modeLower.includes('cinema');
                var hasMusic = modeLower.includes('music');
                var nameMatch = hasThx && hasSelect2 && hasGames && !hasCinema && !hasMusic;
                var codeMatch = modeCode && (String(modeCode).trim() === '0107');
                return nameMatch || codeMatch;
              ]]]
            styles:
              card:
                - background: "linear-gradient(135deg, #f97316 0%, #ea580c 100%)"
                - box-shadow: 0 8px 16px rgba(249, 115, 22, 0.4)
                - transform: scale(1.05)
        styles:
          card:
            - background: "linear-gradient(135deg, #475569 0%, #334155 100%)"
            - border-radius: 20px
            - transition: all 0.3s ease
          name:
            - color: white
            - font-weight: bold
            - font-size: 11px
          icon:
            - color: white
            - width: 32px
      - type: custom:button-card
        entity: media_player.pioneer_avr
        name: THX Surround EX
        icon: mdi:surround-sound-7-1
        tap_action:
          action: call-service
          service: pioneer_avr_lx83.send_raw_command
          service_data:
            entity_id: media_player.pioneer_avr
            command: 0115SR
        state:
          - operator: template
            value: |
              [[[
                var mode = states['media_player.pioneer_avr'].attributes.sound_mode;
                var modeCode = states['media_player.pioneer_avr'].attributes.sound_mode_code;
                if (!mode && !modeCode) return false;
                var modeLower = mode ? mode.toLowerCase().trim() : '';
                var hasThx = modeLower.includes('thx');
                var hasSurroundEx = modeLower.includes('surround ex') || modeLower.includes('surroundex') || modeLower.includes('surround ex');
                var nameMatch = hasThx && hasSurroundEx;
                var codeMatch = modeCode && (String(modeCode).trim() === '0115');
                return nameMatch || codeMatch;
              ]]]
            styles:
              card:
                - background: "linear-gradient(135deg, #dc2626 0%, #b91c1c 100%)"
                - box-shadow: 0 8px 16px rgba(220, 38, 38, 0.4)
                - transform: scale(1.05)
        styles:
          card:
            - background: "linear-gradient(135deg, #475569 0%, #334155 100%)"
            - border-radius: 20px
            - transition: all 0.3s ease
          name:
            - color: white
            - font-weight: bold
            - font-size: 12px
          icon:
            - color: white
            - width: 32px
  - type: custom:mushroom-title-card
    title: üìä √âtat actuel
  - type: grid
    columns: 2
    square: false
    cards:
      - type: custom:mushroom-template-card
        primary: Alimentation
        secondary: |
          {% if is_state('media_player.pioneer_avr', 'on') %}
            ‚óè Allum√©
          {% else %}
            ‚óã √âteint
          {% endif %}
        icon: mdi:power
        icon_color: |
          {% if is_state('media_player.pioneer_avr', 'on') %}
            green
          {% else %}
            red
          {% endif %}
        card_mod:
          style: |
            ha-card {
              background: linear-gradient(135deg, #475569 0%, #334155 100%);
              border-radius: 16px;
            }
      - type: custom:mushroom-template-card
        primary: Source active
        secondary: >-
          {{ state_attr('media_player.pioneer_avr', 'source') | default('Aucune') }}
        icon: mdi:import
        icon_color: purple
        card_mod:
          style: |
            ha-card {
              background: linear-gradient(135deg, #475569 0%, #334155 100%);
              border-radius: 16px;
            }
      - type: custom:mushroom-template-card
        primary: Volume
        secondary: >
          {% if state_attr('media_player.pioneer_avr', 'is_volume_muted') %}
            üîá Muet
          {% elif state_attr('media_player.pioneer_avr', 'volume_level') != None %}
            {{ (state_attr('media_player.pioneer_avr', 'volume_level') * 100) | round }}%
          {% else %}
            N/A
          {% endif %}
        icon: mdi:volume-high
        icon_color: blue
        card_mod:
          style: |
            ha-card {
              background: linear-gradient(135deg, #475569 0%, #334155 100%);
              border-radius: 16px;
            }
      - type: custom:mushroom-template-card
        primary: Mode audio
        secondary: >-
          {{ state_attr('media_player.pioneer_avr', 'sound_mode') | default('N/A') }}
        icon: mdi:surround-sound
        icon_color: cyan
        card_mod:
          style: |
            ha-card {
              background: linear-gradient(135deg, #475569 0%, #334155 100%);
              border-radius: 16px;
            }
      - type: custom:mushroom-template-card
        primary: Code du mode
        secondary: >-
          {{ state_attr('media_player.pioneer_avr', 'sound_mode_code') | default('N/A') }}
        icon: mdi:code-json
        icon_color: amber
        card_mod:
          style: |
            ha-card {
              background: linear-gradient(135deg, #475569 0%, #334155 100%);
              border-radius: 16px;
            }
      - type: custom:mushroom-template-card
        primary: Derni√®re r√©ponse
        secondary: >-
          {{ state_attr('media_player.pioneer_avr', 'last_response') | default('Aucune') }}
        icon: mdi:reply
        icon_color: green
        card_mod:
          style: |
            ha-card {
              background: linear-gradient(135deg, #475569 0%, #334155 100%);
              border-radius: 16px;
            }