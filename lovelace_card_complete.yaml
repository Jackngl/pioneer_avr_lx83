type: vertical-stack
cards:
  - type: custom:mushroom-title-card
    title: Pioneer AVR
    subtitle: Amplificateur Audio/VidÃ©o
  - type: horizontal-stack
    cards:
      - type: custom:mushroom-entity-card
        entity: media_player.ampli
        name: Alimentation
        icon: mdi:power
        tap_action:
          action: toggle
        hold_action:
          action: more-info
        card_mod:
          style: |
            ha-card {
              background: linear-gradient(135deg, #1e293b 0%, #334155 100%);
              border-radius: 20px;
              box-shadow: 0 8px 16px rgba(0,0,0,0.3);
            }
      - type: custom:mushroom-template-card
        primary: "{{ states('media_player.ampli') | title }}"
        secondary: >-
          {{ state_attr('media_player.ampli', 'source') | default('Aucune
          source') }}
        icon: mdi:speaker
        icon_color: |
          {% if is_state('media_player.ampli', 'on') %}
            green
          {% else %}
            red
          {% endif %}
        card_mod:
          style: |
            ha-card {
              background: linear-gradient(135deg, #1e293b 0%, #334155 100%);
              border-radius: 20px;
              box-shadow: 0 8px 16px rgba(0,0,0,0.3);
            }
  - type: custom:mushroom-media-player-card
    entity: media_player.ampli
    use_media_info: false
    use_media_artwork: false
    show_volume_level: true
    volume_controls:
      - volume_mute
      - volume_set
      - volume_buttons
    card_mod:
      style: |
        ha-card {
          background: linear-gradient(135deg, #1e293b 0%, #334155 100%);
          border-radius: 20px;
          box-shadow: 0 8px 16px rgba(0,0,0,0.3);
          padding: 16px;
        }
  - type: custom:mushroom-title-card
    title: ðŸŽµ Sources Audio
  - type: grid
    columns: 5
    square: false
    cards:
      - type: custom:button-card
        entity: media_player.ampli
        name: CD
        icon: mdi:disc-player
        tap_action:
          action: call-service
          service: media_player.select_source
          service_data:
            entity_id: media_player.ampli
            source: CD
        state:
          - operator: template
            value: |
              [[[
                var source = states['media_player.ampli'].attributes.source;
                var resp = states['media_player.ampli'].attributes.last_response;
                return source === 'CD' || (resp && resp.includes('FN01'));
              ]]]
            styles:
              card:
                - background: "linear-gradient(135deg, #a855f7 0%, #ec4899 100%)"
                - box-shadow: 0 8px 16px rgba(168, 85, 247, 0.4)
                - transform: scale(1.05)
        styles:
          card:
            - background: "linear-gradient(135deg, #475569 0%, #334155 100%)"
            - border-radius: 20px
            - transition: all 0.3s ease
          name:
            - color: white
            - font-weight: bold
            - font-size: 14px
          icon:
            - color: white
            - width: 32px
      - type: custom:button-card
        entity: media_player.ampli
        name: Tuner
        icon: mdi:radio
        tap_action:
          action: call-service
          service: media_player.select_source
          service_data:
            entity_id: media_player.ampli
            source: Tuner
        state:
          - operator: template
            value: |
              [[[
                var source = states['media_player.ampli'].attributes.source;
                var resp = states['media_player.ampli'].attributes.last_response;
                return source === 'Tuner' || (resp && resp.includes('FN02'));
              ]]]
            styles:
              card:
                - background: "linear-gradient(135deg, #eab308 0%, #f97316 100%)"
                - box-shadow: 0 8px 16px rgba(234, 179, 8, 0.4)
                - transform: scale(1.05)
        styles:
          card:
            - background: "linear-gradient(135deg, #475569 0%, #334155 100%)"
            - border-radius: 20px
            - transition: all 0.3s ease
          name:
            - color: white
            - font-weight: bold
            - font-size: 14px
          icon:
            - color: white
            - width: 32px
      - type: custom:button-card
        entity: media_player.ampli
        name: Phono
        icon: mdi:album
        tap_action:
          action: call-service
          service: media_player.select_source
          service_data:
            entity_id: media_player.ampli
            source: Phono
        state:
          - operator: template
            value: |
              [[[
                var source = states['media_player.ampli'].attributes.source;
                var resp = states['media_player.ampli'].attributes.last_response;
                return source === 'Phono' || (resp && resp.includes('FN00'));
              ]]]
            styles:
              card:
                - background: "linear-gradient(135deg, #f43f5e 0%, #dc2626 100%)"
                - box-shadow: 0 8px 16px rgba(244, 63, 94, 0.4)
                - transform: scale(1.05)
        styles:
          card:
            - background: "linear-gradient(135deg, #475569 0%, #334155 100%)"
            - border-radius: 20px
            - transition: all 0.3s ease
          name:
            - color: white
            - font-weight: bold
            - font-size: 14px
          icon:
            - color: white
            - width: 32px
      - type: custom:button-card
        entity: media_player.ampli
        name: iPod/USB
        icon: mdi:usb
        tap_action:
          action: call-service
          service: media_player.select_source
          service_data:
            entity_id: media_player.ampli
            source: iPod/USB
        state:
          - operator: template
            value: |
              [[[
                var source = states['media_player.ampli'].attributes.source;
                var resp = states['media_player.ampli'].attributes.last_response;
                return source === 'iPod/USB' || (resp && resp.includes('FN17'));
              ]]]
            styles:
              card:
                - background: "linear-gradient(135deg, #8b5cf6 0%, #a855f7 100%)"
                - box-shadow: 0 8px 16px rgba(139, 92, 246, 0.4)
                - transform: scale(1.05)
        styles:
          card:
            - background: "linear-gradient(135deg, #475569 0%, #334155 100%)"
            - border-radius: 20px
            - transition: all 0.3s ease
          name:
            - color: white
            - font-weight: bold
            - font-size: 14px
          icon:
            - color: white
            - width: 32px
      - type: custom:button-card
        entity: media_player.ampli
        name: Bluetooth
        icon: mdi:bluetooth
        tap_action:
          action: call-service
          service: media_player.select_source
          service_data:
            entity_id: media_player.ampli
            source: Bluetooth
        state:
          - operator: template
            value: |
              [[[
                var source = states['media_player.ampli'].attributes.source;
                var resp = states['media_player.ampli'].attributes.last_response;
                return source === 'Bluetooth' || (resp && resp.includes('FN33'));
              ]]]
            styles:
              card:
                - background: "linear-gradient(135deg, #06b6d4 0%, #3b82f6 100%)"
                - box-shadow: 0 8px 16px rgba(6, 182, 212, 0.4)
                - transform: scale(1.05)
        styles:
          card:
            - background: "linear-gradient(135deg, #475569 0%, #334155 100%)"
            - border-radius: 20px
            - transition: all 0.3s ease
          name:
            - color: white
            - font-weight: bold
            - font-size: 14px
          icon:
            - color: white
            - width: 32px
  - type: vertical-stack
    cards:
      - type: custom:mushroom-title-card
        title: ðŸ“» Stations FM
        subtitle: ""
      - type: grid
        columns: 4
        square: false
        cards:
          - type: custom:button-card
            entity: media_player.ampli
            name: Preset 1
            icon: mdi:numeric-1-circle
            tap_action:
              action: call-service
              service: pioneer_avr_lx83.send_raw_command
              service_data:
                entity_id: media_player.ampli
                command: 01TP
            state:
              - operator: template
                value: |
                  [[[
                    return states['media_player.ampli'].attributes.source === 'Tuner';
                  ]]]
                styles:
                  card:
                    - background: "linear-gradient(135deg, #f59e0b 0%, #f97316 100%)"
                    - opacity: 1
              - operator: template
                value: |
                  [[[
                    return states['media_player.ampli'].attributes.source !== 'Tuner';
                  ]]]
                styles:
                  card:
                    - background: "linear-gradient(135deg, #475569 0%, #334155 100%)"
                    - opacity: 0.5
                    - cursor: not-allowed
            styles:
              card:
                - border-radius: 16px
                - transition: all 0.3s ease
                - box-shadow: 0 4px 8px rgba(245, 158, 11, 0.3)
              name:
                - color: white
                - font-weight: bold
                - font-size: 13px
              icon:
                - color: white
                - width: 28px
          - type: custom:button-card
            entity: media_player.ampli
            name: Preset 2
            icon: mdi:numeric-2-circle
            tap_action:
              action: call-service
              service: pioneer_avr_lx83.send_raw_command
              service_data:
                entity_id: media_player.ampli
                command: 02TP
            state:
              - operator: template
                value: |
                  [[[
                    return states['media_player.ampli'].attributes.source === 'Tuner';
                  ]]]
                styles:
                  card:
                    - background: "linear-gradient(135deg, #f59e0b 0%, #f97316 100%)"
                    - opacity: 1
              - operator: template
                value: |
                  [[[
                    return states['media_player.ampli'].attributes.source !== 'Tuner';
                  ]]]
                styles:
                  card:
                    - background: "linear-gradient(135deg, #475569 0%, #334155 100%)"
                    - opacity: 0.5
                    - cursor: not-allowed
            styles:
              card:
                - border-radius: 16px
                - transition: all 0.3s ease
                - box-shadow: 0 4px 8px rgba(245, 158, 11, 0.3)
              name:
                - color: white
                - font-weight: bold
                - font-size: 13px
              icon:
                - color: white
                - width: 28px
          - type: custom:button-card
            entity: media_player.ampli
            name: Preset 3
            icon: mdi:numeric-3-circle
            tap_action:
              action: call-service
              service: pioneer_avr_lx83.send_raw_command
              service_data:
                entity_id: media_player.ampli
                command: 03TP
            state:
              - operator: template
                value: |
                  [[[
                    return states['media_player.ampli'].attributes.source === 'Tuner';
                  ]]]
                styles:
                  card:
                    - opacity: 1
              - operator: template
                value: |
                  [[[
                    return states['media_player.ampli'].attributes.source !== 'Tuner';
                  ]]]
                styles:
                  card:
                    - background: "linear-gradient(135deg, #475569 0%, #334155 100%)"
                    - opacity: 0.5
                    - cursor: not-allowed
            styles:
              card:
                - background: "linear-gradient(135deg, #f59e0b 0%, #f97316 100%)"
                - border-radius: 16px
                - transition: all 0.3s ease
                - box-shadow: 0 4px 8px rgba(245, 158, 11, 0.3)
              name:
                - color: white
                - font-weight: bold
                - font-size: 13px
              icon:
                - color: white
                - width: 28px
          - type: custom:button-card
            entity: media_player.ampli
            name: Preset 4
            icon: mdi:numeric-4-circle
            tap_action:
              action: call-service
              service: pioneer_avr_lx83.send_raw_command
              service_data:
                entity_id: media_player.ampli
                command: 04TP
            state:
              - operator: template
                value: |
                  [[[
                    return states['media_player.ampli'].attributes.source === 'Tuner';
                  ]]]
                styles:
                  card:
                    - opacity: 1
              - operator: template
                value: |
                  [[[
                    return states['media_player.ampli'].attributes.source !== 'Tuner';
                  ]]]
                styles:
                  card:
                    - background: "linear-gradient(135deg, #475569 0%, #334155 100%)"
                    - opacity: 0.5
                    - cursor: not-allowed
            styles:
              card:
                - background: "linear-gradient(135deg, #f59e0b 0%, #f97316 100%)"
                - border-radius: 16px
                - transition: all 0.3s ease
                - box-shadow: 0 4px 8px rgba(245, 158, 11, 0.3)
              name:
                - color: white
                - font-weight: bold
                - font-size: 13px
              icon:
                - color: white
                - width: 28px
          - type: custom:button-card
            entity: media_player.ampli
            name: Preset 5
            icon: mdi:numeric-5-circle
            tap_action:
              action: call-service
              service: pioneer_avr_lx83.send_raw_command
              service_data:
                entity_id: media_player.ampli
                command: 05TP
            state:
              - operator: template
                value: |
                  [[[
                    return states['media_player.ampli'].attributes.source === 'Tuner';
                  ]]]
                styles:
                  card:
                    - opacity: 1
              - operator: template
                value: |
                  [[[
                    return states['media_player.ampli'].attributes.source !== 'Tuner';
                  ]]]
                styles:
                  card:
                    - background: "linear-gradient(135deg, #475569 0%, #334155 100%)"
                    - opacity: 0.5
                    - cursor: not-allowed
            styles:
              card:
                - background: "linear-gradient(135deg, #10b981 0%, #059669 100%)"
                - border-radius: 16px
                - transition: all 0.3s ease
                - box-shadow: 0 4px 8px rgba(16, 185, 129, 0.3)
              name:
                - color: white
                - font-weight: bold
                - font-size: 13px
              icon:
                - color: white
                - width: 28px
          - type: custom:button-card
            entity: media_player.ampli
            name: Preset 6
            icon: mdi:numeric-6-circle
            tap_action:
              action: call-service
              service: pioneer_avr_lx83.send_raw_command
              service_data:
                entity_id: media_player.ampli
                command: 06TP
            state:
              - operator: template
                value: |
                  [[[
                    return states['media_player.ampli'].attributes.source === 'Tuner';
                  ]]]
                styles:
                  card:
                    - opacity: 1
              - operator: template
                value: |
                  [[[
                    return states['media_player.ampli'].attributes.source !== 'Tuner';
                  ]]]
                styles:
                  card:
                    - background: "linear-gradient(135deg, #475569 0%, #334155 100%)"
                    - opacity: 0.5
                    - cursor: not-allowed
            styles:
              card:
                - background: "linear-gradient(135deg, #10b981 0%, #059669 100%)"
                - border-radius: 16px
                - transition: all 0.3s ease
                - box-shadow: 0 4px 8px rgba(16, 185, 129, 0.3)
              name:
                - color: white
                - font-weight: bold
                - font-size: 13px
              icon:
                - color: white
                - width: 28px
          - type: custom:button-card
            entity: media_player.ampli
            name: Preset 7
            icon: mdi:numeric-7-circle
            tap_action:
              action: call-service
              service: pioneer_avr_lx83.send_raw_command
              service_data:
                entity_id: media_player.ampli
                command: 07TP
            state:
              - operator: template
                value: |
                  [[[
                    return states['media_player.ampli'].attributes.source === 'Tuner';
                  ]]]
                styles:
                  card:
                    - opacity: 1
              - operator: template
                value: |
                  [[[
                    return states['media_player.ampli'].attributes.source !== 'Tuner';
                  ]]]
                styles:
                  card:
                    - background: "linear-gradient(135deg, #475569 0%, #334155 100%)"
                    - opacity: 0.5
                    - cursor: not-allowed
            styles:
              card:
                - background: "linear-gradient(135deg, #10b981 0%, #059669 100%)"
                - border-radius: 16px
                - transition: all 0.3s ease
                - box-shadow: 0 4px 8px rgba(16, 185, 129, 0.3)
              name:
                - color: white
                - font-weight: bold
                - font-size: 13px
              icon:
                - color: white
                - width: 28px
          - type: custom:button-card
            entity: media_player.ampli
            name: Preset 8
            icon: mdi:numeric-8-circle
            tap_action:
              action: call-service
              service: pioneer_avr_lx83.send_raw_command
              service_data:
                entity_id: media_player.ampli
                command: 08TP
            state:
              - operator: template
                value: |
                  [[[
                    return states['media_player.ampli'].attributes.source === 'Tuner';
                  ]]]
                styles:
                  card:
                    - opacity: 1
              - operator: template
                value: |
                  [[[
                    return states['media_player.ampli'].attributes.source !== 'Tuner';
                  ]]]
                styles:
                  card:
                    - background: "linear-gradient(135deg, #475569 0%, #334155 100%)"
                    - opacity: 0.5
                    - cursor: not-allowed
            styles:
              card:
                - background: "linear-gradient(135deg, #10b981 0%, #059669 100%)"
                - border-radius: 16px
                - transition: all 0.3s ease
                - box-shadow: 0 4px 8px rgba(16, 185, 129, 0.3)
              name:
                - color: white
                - font-weight: bold
                - font-size: 13px
              icon:
                - color: white
                - width: 28px
      - type: horizontal-stack
        cards:
          - type: custom:button-card
            entity: media_player.ampli
            name: â—€ PrÃ©cÃ©dent
            icon: mdi:skip-previous
            tap_action:
              action: call-service
              service: pioneer_avr_lx83.send_raw_command
              service_data:
                entity_id: media_player.ampli
                command: TPD
            state:
              - operator: template
                value: |
                  [[[
                    return states['media_player.ampli'].attributes.source === 'Tuner';
                  ]]]
                styles:
                  card:
                    - opacity: 1
              - operator: template
                value: |
                  [[[
                    return states['media_player.ampli'].attributes.source !== 'Tuner';
                  ]]]
                styles:
                  card:
                    - background: "linear-gradient(135deg, #475569 0%, #334155 100%)"
                    - opacity: 0.5
                    - cursor: not-allowed
            styles:
              card:
                - background: "linear-gradient(135deg, #3b82f6 0%, #2563eb 100%)"
                - border-radius: 16px
                - padding: 12px
              name:
                - color: white
                - font-weight: bold
              icon:
                - color: white
                - width: 28px
          - type: custom:button-card
            entity: media_player.ampli
            name: Suivant â–¶
            icon: mdi:skip-next
            tap_action:
              action: call-service
              service: pioneer_avr_lx83.send_raw_command
              service_data:
                entity_id: media_player.ampli
                command: TPI
            state:
              - operator: template
                value: |
                  [[[
                    return states['media_player.ampli'].attributes.source === 'Tuner';
                  ]]]
                styles:
                  card:
                    - opacity: 1
              - operator: template
                value: |
                  [[[
                    return states['media_player.ampli'].attributes.source !== 'Tuner';
                  ]]]
                styles:
                  card:
                    - background: "linear-gradient(135deg, #475569 0%, #334155 100%)"
                    - opacity: 0.5
                    - cursor: not-allowed
            styles:
              card:
                - background: "linear-gradient(135deg, #3b82f6 0%, #2563eb 100%)"
                - border-radius: 16px
                - padding: 12px
              name:
                - color: white
                - font-weight: bold
              icon:
                - color: white
                - width: 28px
      - type: horizontal-stack
        cards:
          - type: custom:button-card
            entity: media_player.ampli
            name: FrÃ©quence +
            icon: mdi:arrow-up
            tap_action:
              action: call-service
              service: pioneer_avr_lx83.send_raw_command
              service_data:
                entity_id: media_player.ampli
                command: TFI
            state:
              - operator: template
                value: |
                  [[[
                    return states['media_player.ampli'].attributes.source === 'Tuner';
                  ]]]
                styles:
                  card:
                    - opacity: 1
              - operator: template
                value: |
                  [[[
                    return states['media_player.ampli'].attributes.source !== 'Tuner';
                  ]]]
                styles:
                  card:
                    - background: "linear-gradient(135deg, #475569 0%, #334155 100%)"
                    - opacity: 0.5
                    - cursor: not-allowed
            styles:
              card:
                - background: "linear-gradient(135deg, #8b5cf6 0%, #a855f7 100%)"
                - border-radius: 16px
                - padding: 12px
              name:
                - color: white
                - font-weight: bold
              icon:
                - color: white
                - width: 28px
          - type: custom:button-card
            entity: media_player.ampli
            name: FrÃ©quence -
            icon: mdi:arrow-down
            tap_action:
              action: call-service
              service: pioneer_avr_lx83.send_raw_command
              service_data:
                entity_id: media_player.ampli
                command: TFD
            state:
              - operator: template
                value: |
                  [[[
                    return states['media_player.ampli'].attributes.source === 'Tuner';
                  ]]]
                styles:
                  card:
                    - opacity: 1
              - operator: template
                value: |
                  [[[
                    return states['media_player.ampli'].attributes.source !== 'Tuner';
                  ]]]
                styles:
                  card:
                    - background: "linear-gradient(135deg, #475569 0%, #334155 100%)"
                    - opacity: 0.5
                    - cursor: not-allowed
            styles:
              card:
                - background: "linear-gradient(135deg, #8b5cf6 0%, #a855f7 100%)"
                - border-radius: 16px
                - padding: 12px
              name:
                - color: white
                - font-weight: bold
              icon:
                - color: white
                - width: 28px
  - type: custom:mushroom-title-card
    title: ðŸ“º Sources VidÃ©o
  - type: grid
    columns: 3
    square: false
    cards:
      - type: custom:button-card
        entity: media_player.ampli
        name: DVD
        icon: mdi:disc
        tap_action:
          action: call-service
          service: media_player.select_source
          service_data:
            entity_id: media_player.ampli
            source: DVD
        state:
          - operator: template
            value: |
              [[[
                var source = states['media_player.ampli'].attributes.source;
                var resp = states['media_player.ampli'].attributes.last_response;
                return source === 'DVD' || (resp && resp.includes('FN04'));
              ]]]
            styles:
              card:
                - background: "linear-gradient(135deg, #3b82f6 0%, #06b6d4 100%)"
                - box-shadow: 0 8px 16px rgba(59, 130, 246, 0.4)
                - transform: scale(1.05)
        styles:
          card:
            - background: "linear-gradient(135deg, #475569 0%, #334155 100%)"
            - border-radius: 20px
            - transition: all 0.3s ease
          name:
            - color: white
            - font-weight: bold
            - font-size: 14px
          icon:
            - color: white
            - width: 32px
      - type: custom:button-card
        entity: media_player.ampli
        name: BD
        icon: mdi:disc
        tap_action:
          action: call-service
          service: media_player.select_source
          service_data:
            entity_id: media_player.ampli
            source: BD
        state:
          - operator: template
            value: |
              [[[
                var source = states['media_player.ampli'].attributes.source;
                var resp = states['media_player.ampli'].attributes.last_response;
                return source === 'BD' || (resp && resp.includes('FN25'));
              ]]]
            styles:
              card:
                - background: "linear-gradient(135deg, #6366f1 0%, #3b82f6 100%)"
                - box-shadow: 0 8px 16px rgba(99, 102, 241, 0.4)
                - transform: scale(1.05)
        styles:
          card:
            - background: "linear-gradient(135deg, #475569 0%, #334155 100%)"
            - border-radius: 20px
            - transition: all 0.3s ease
          name:
            - color: white
            - font-weight: bold
            - font-size: 14px
          icon:
            - color: white
            - width: 32px
      - type: custom:button-card
        entity: media_player.ampli
        name: TV/Sat
        icon: mdi:television
        tap_action:
          action: call-service
          service: media_player.select_source
          service_data:
            entity_id: media_player.ampli
            source: TV/Sat
        state:
          - operator: template
            value: |
              [[[
                var source = states['media_player.ampli'].attributes.source;
                var resp = states['media_player.ampli'].attributes.last_response;
                return source === 'TV/Sat' || (resp && resp.includes('FN05'));
              ]]]
            styles:
              card:
                - background: "linear-gradient(135deg, #f97316 0%, #dc2626 100%)"
                - box-shadow: 0 8px 16px rgba(249, 115, 22, 0.4)
                - transform: scale(1.05)
        styles:
          card:
            - background: "linear-gradient(135deg, #475569 0%, #334155 100%)"
            - border-radius: 20px
            - transition: all 0.3s ease
          name:
            - color: white
            - font-weight: bold
            - font-size: 14px
          icon:
            - color: white
            - width: 32px
  - type: custom:mushroom-title-card
    title: ðŸŽ§ Modes Audio
  - type: custom:mushroom-title-card
    title: Modes de base
    subtitle: Modes audio fondamentaux
  - type: grid
    columns: 3
    square: false
    cards:
      - type: custom:button-card
        entity: media_player.ampli
        name: StÃ©rÃ©o
        icon: mdi:speaker-multiple
        tap_action:
          action: call-service
          service: pioneer_avr_lx83.send_raw_command
          service_data:
            entity_id: media_player.ampli
            command: 0001SR
        state:
          - operator: template
            value: |
              [[[
                var code = states['media_player.ampli'].attributes.sound_mode_code;
                return code === '0001';
              ]]]
            styles:
              card:
                - background: "linear-gradient(135deg, #10b981 0%, #059669 100%)"
                - box-shadow: 0 8px 16px rgba(16, 185, 129, 0.4)
                - transform: scale(1.05)
        styles:
          card:
            - background: "linear-gradient(135deg, #475569 0%, #334155 100%)"
            - border-radius: 20px
            - transition: all 0.3s ease
          name:
            - color: white
            - font-weight: bold
            - font-size: 14px
          icon:
            - color: white
            - width: 32px
      - type: custom:button-card
        entity: media_player.ampli
        name: Auto Surround
        icon: mdi:surround-sound
        tap_action:
          action: call-service
          service: pioneer_avr_lx83.send_raw_command
          service_data:
            entity_id: media_player.ampli
            command: 0006SR
        state:
          - operator: template
            value: |
              [[[
                var code = states['media_player.ampli'].attributes.sound_mode_code;
                return code === '0006';
              ]]]
            styles:
              card:
                - background: "linear-gradient(135deg, #8b5cf6 0%, #a855f7 100%)"
                - box-shadow: 0 8px 16px rgba(139, 92, 246, 0.4)
                - transform: scale(1.05)
        styles:
          card:
            - background: "linear-gradient(135deg, #475569 0%, #334155 100%)"
            - border-radius: 20px
            - transition: all 0.3s ease
          name:
            - color: white
            - font-weight: bold
            - font-size: 13px
          icon:
            - color: white
            - width: 32px
      - type: custom:button-card
        entity: media_player.ampli
        name: Direct
        icon: mdi:volume-high
        tap_action:
          action: call-service
          service: pioneer_avr_lx83.send_raw_command
          service_data:
            entity_id: media_player.ampli
            command: 0007SR
        state:
          - operator: template
            value: |
              [[[
                var code = states['media_player.ampli'].attributes.sound_mode_code;
                return code === '0007';
              ]]]
            styles:
              card:
                - background: "linear-gradient(135deg, #06b6d4 0%, #3b82f6 100%)"
                - box-shadow: 0 8px 16px rgba(6, 182, 212, 0.4)
                - transform: scale(1.05)
        styles:
          card:
            - background: "linear-gradient(135deg, #475569 0%, #334155 100%)"
            - border-radius: 20px
            - transition: all 0.3s ease
          name:
            - color: white
            - font-weight: bold
            - font-size: 14px
          icon:
            - color: white
            - width: 32px
      - type: custom:button-card
        entity: media_player.ampli
        name: Pure Direct
        icon: mdi:music-circle
        tap_action:
          action: call-service
          service: pioneer_avr_lx83.send_raw_command
          service_data:
            entity_id: media_player.ampli
            command: 0008SR
        state:
          - operator: template
            value: |
              [[[
                var code = states['media_player.ampli'].attributes.sound_mode_code;
                return code === '0008';
              ]]]
            styles:
              card:
                - background: "linear-gradient(135deg, #f59e0b 0%, #f97316 100%)"
                - box-shadow: 0 8px 16px rgba(245, 158, 11, 0.4)
                - transform: scale(1.05)
        styles:
          card:
            - background: "linear-gradient(135deg, #475569 0%, #334155 100%)"
            - border-radius: 20px
            - transition: all 0.3s ease
          name:
            - color: white
            - font-weight: bold
            - font-size: 13px
          icon:
            - color: white
            - width: 32px
      - type: custom:button-card
        entity: media_player.ampli
        name: Advanced Game
        icon: mdi:gamepad-variant
        tap_action:
          action: call-service
          service: pioneer_avr_lx83.send_raw_command
          service_data:
            entity_id: media_player.ampli
            command: 0118SR
        state:
          - operator: template
            value: |
              [[[
                var code = states['media_player.ampli'].attributes.sound_mode_code;
                return code === '0118';
              ]]]
            styles:
              card:
                - background: "linear-gradient(135deg, #ec4899 0%, #db2777 100%)"
                - box-shadow: 0 8px 16px rgba(236, 72, 153, 0.4)
                - transform: scale(1.05)
        styles:
          card:
            - background: "linear-gradient(135deg, #475569 0%, #334155 100%)"
            - border-radius: 20px
            - transition: all 0.3s ease
          name:
            - color: white
            - font-weight: bold
            - font-size: 12px
          icon:
            - color: white
            - width: 32px
      - type: custom:button-card
        entity: media_player.ampli
        name: Extended Stereo
        icon: mdi:speaker-wireless
        tap_action:
          action: call-service
          service: pioneer_avr_lx83.send_raw_command
          service_data:
            entity_id: media_player.ampli
            command: 0112SR
        state:
          - operator: template
            value: |
              [[[
                var code = states['media_player.ampli'].attributes.sound_mode_code;
                return code === '0112';
              ]]]
            styles:
              card:
                - background: "linear-gradient(135deg, #6366f1 0%, #4f46e5 100%)"
                - box-shadow: 0 8px 16px rgba(99, 102, 241, 0.4)
                - transform: scale(1.05)
        styles:
          card:
            - background: "linear-gradient(135deg, #475569 0%, #334155 100%)"
            - border-radius: 20px
            - transition: all 0.3s ease
          name:
            - color: white
            - font-weight: bold
            - font-size: 14px
          icon:
            - color: white
            - width: 32px
  - type: custom:mushroom-title-card
    title: Modes Dolby Pro Logic
    subtitle: Modes Dolby et DTS
  - type: grid
    columns: 3
    square: false
    cards:
      - type: custom:button-card
        entity: media_player.ampli
        name: Cycle Dolby/DTS
        icon: mdi:sync
        tap_action:
          action: call-service
          service: pioneer_avr_lx83.send_raw_command
          service_data:
            entity_id: media_player.ampli
            command: 0010SR
        subtitle: |
          Appuyer plusieurs fois pour changer
        state:
          - operator: template
            value: |
              [[[
                var mode = states['media_player.ampli'].attributes.sound_mode;
                if (!mode) return false;
                var modeLower = mode.toLowerCase().trim();
                return modeLower.includes('pro logic') || modeLower.includes('neo:6') || modeLower.includes('neural');
              ]]]
            styles:
              card:
                - background: "linear-gradient(135deg, #8b5cf6 0%, #7c3aed 100%)"
                - box-shadow: 0 8px 16px rgba(139, 92, 246, 0.4)
                - transform: scale(1.05)
        styles:
          card:
            - background: "linear-gradient(135deg, #475569 0%, #334155 100%)"
            - border-radius: 20px
            - transition: all 0.3s ease
          name:
            - color: white
            - font-weight: bold
            - font-size: 14px
          icon:
            - color: white
            - width: 32px
      - type: custom:button-card
        entity: media_player.ampli
        name: PL II Movie
        icon: mdi:movie-open-outline
        tap_action:
          action: call-service
          service: pioneer_avr_lx83.send_raw_command
          service_data:
            entity_id: media_player.ampli
            command: 0013SR
        state:
          - operator: template
            value: |
              [[[
                var code = states['media_player.ampli'].attributes.sound_mode_code;
                return code === '0013';
              ]]]
            styles:
              card:
                - background: "linear-gradient(135deg, #8b5cf6 0%, #7c3aed 100%)"
                - box-shadow: 0 8px 16px rgba(139, 92, 246, 0.4)
                - transform: scale(1.05)
        styles:
          card:
            - background: "linear-gradient(135deg, #475569 0%, #334155 100%)"
            - border-radius: 20px
            - transition: all 0.3s ease
          name:
            - color: white
            - font-weight: bold
            - font-size: 12px
          icon:
            - color: white
            - width: 32px
      - type: custom:button-card
        entity: media_player.ampli
        name: PL II Music
        icon: mdi:music-note
        tap_action:
          action: call-service
          service: pioneer_avr_lx83.send_raw_command
          service_data:
            entity_id: media_player.ampli
            command: 0014SR
        state:
          - operator: template
            value: |
              [[[
                var code = states['media_player.ampli'].attributes.sound_mode_code;
                return code === '0014';
              ]]]
            styles:
              card:
                - background: "linear-gradient(135deg, #a855f7 0%, #9333ea 100%)"
                - box-shadow: 0 8px 16px rgba(168, 85, 247, 0.4)
                - transform: scale(1.05)
        styles:
          card:
            - background: "linear-gradient(135deg, #475569 0%, #334155 100%)"
            - border-radius: 20px
            - transition: all 0.3s ease
          name:
            - color: white
            - font-weight: bold
            - font-size: 12px
          icon:
            - color: white
            - width: 32px
      - type: custom:button-card
        entity: media_player.ampli
        name: Dolby Surround
        icon: mdi:surround-sound-5-1
        tap_action:
          action: call-service
          service: pioneer_avr_lx83.send_raw_command
          service_data:
            entity_id: media_player.ampli
            command: 0151SR
        state:
          - operator: template
            value: |
              [[[
                var code = states['media_player.ampli'].attributes.sound_mode_code;
                return code === '0151';
              ]]]
            styles:
              card:
                - background: "linear-gradient(135deg, #06b6d4 0%, #0891b2 100%)"
                - box-shadow: 0 8px 16px rgba(6, 182, 212, 0.4)
                - transform: scale(1.05)
        styles:
          card:
            - background: "linear-gradient(135deg, #475569 0%, #334155 100%)"
            - border-radius: 20px
            - transition: all 0.3s ease
          name:
            - color: white
            - font-weight: bold
            - font-size: 13px
          icon:
            - color: white
            - width: 32px
      - type: custom:button-card
        entity: media_player.ampli
        name: Cycle Dolby+THX
        icon: mdi:sync-circle
        tap_action:
          action: call-service
          service: pioneer_avr_lx83.send_raw_command
          service_data:
            entity_id: media_player.ampli
            command: 0050SR
        subtitle: |
          Appuyer plusieurs fois pour changer
        state:
          - operator: template
            value: |
              [[[
                var code = states['media_player.ampli'].attributes.sound_mode_code;
                if (!code) return false;
                var codeStr = String(code).trim();
                return codeStr.startsWith('005'); // THX range 0051-0057
              ]]]
            styles:
              card:
                - background: "linear-gradient(135deg, #dc2626 0%, #991b1b 100%)"
                - box-shadow: 0 8px 16px rgba(220, 38, 38, 0.4)
                - transform: scale(1.05)
        styles:
          card:
            - background: "linear-gradient(135deg, #475569 0%, #334155 100%)"
            - border-radius: 20px
            - transition: all 0.3s ease
          name:
            - color: white
            - font-weight: bold
            - font-size: 12px
          icon:
            - color: white
            - width: 32px
      - type: custom:button-card
        entity: media_player.ampli
        name: Cycle DSP
        icon: mdi:equalizer
        tap_action:
          action: call-service
          service: pioneer_avr_lx83.send_raw_command
          service_data:
            entity_id: media_player.ampli
            command: 0100SR
        subtitle: |
          Classical, Rock, Action, etc.
        state:
          - operator: template
            value: |
              [[[
                var code = states['media_player.ampli'].attributes.sound_mode_code;
                if (!code) return false;
                var codeStr = String(code).trim();
                return codeStr.startsWith('010') || codeStr === '0112' || codeStr === '0118';
              ]]]
            styles:
              card:
                - background: "linear-gradient(135deg, #f97316 0%, #ea580c 100%)"
                - box-shadow: 0 8px 16px rgba(249, 115, 22, 0.4)
                - transform: scale(1.05)
        styles:
          card:
            - background: "linear-gradient(135deg, #475569 0%, #334155 100%)"
            - border-radius: 20px
            - transition: all 0.3s ease
          name:
            - color: white
            - font-weight: bold
            - font-size: 12px
          icon:
            - color: white
            - width: 32px
  - type: custom:mushroom-title-card
    title: Modes THX
    subtitle: Modes cinÃ©ma, musique et jeux THX
  - type: grid
    columns: 3
    square: false
    cards:
      - type: custom:button-card
        entity: media_player.ampli
        name: THX Cinema
        icon: mdi:movie-open
        tap_action:
          action: call-service
          service: pioneer_avr_lx83.send_raw_command
          service_data:
            entity_id: media_player.ampli
            command: 0051SR
        state:
          - operator: template
            value: |
              [[[
                var code = states['media_player.ampli'].attributes.sound_mode_code;
                return code === '0051';
              ]]]
            styles:
              card:
                - background: "linear-gradient(135deg, #dc2626 0%, #991b1b 100%)"
                - box-shadow: 0 8px 16px rgba(220, 38, 38, 0.4)
                - transform: scale(1.05)
        styles:
          card:
            - background: "linear-gradient(135deg, #475569 0%, #334155 100%)"
            - border-radius: 20px
            - transition: all 0.3s ease
          name:
            - color: white
            - font-weight: bold
            - font-size: 13px
          icon:
            - color: white
            - width: 32px
      - type: custom:button-card
        entity: media_player.ampli
        name: THX Music
        icon: mdi:music-circle
        tap_action:
          action: call-service
          service: pioneer_avr_lx83.send_raw_command
          service_data:
            entity_id: media_player.ampli
            command: 0052SR
        state:
          - operator: template
            value: |
              [[[
                var code = states['media_player.ampli'].attributes.sound_mode_code;
                return code === '0052';
              ]]]
            styles:
              card:
                - background: "linear-gradient(135deg, #ec4899 0%, #db2777 100%)"
                - box-shadow: 0 8px 16px rgba(236, 72, 153, 0.4)
                - transform: scale(1.05)
        styles:
          card:
            - background: "linear-gradient(135deg, #475569 0%, #334155 100%)"
            - border-radius: 20px
            - transition: all 0.3s ease
          name:
            - color: white
            - font-weight: bold
            - font-size: 13px
          icon:
            - color: white
            - width: 32px
      - type: custom:button-card
        entity: media_player.ampli
        name: THX Games
        icon: mdi:gamepad
        tap_action:
          action: call-service
          service: pioneer_avr_lx83.send_raw_command
          service_data:
            entity_id: media_player.ampli
            command: 0053SR
        state:
          - operator: template
            value: |
              [[[
                var code = states['media_player.ampli'].attributes.sound_mode_code;
                return code === '0053';
              ]]]
            styles:
              card:
                - background: "linear-gradient(135deg, #f97316 0%, #ea580c 100%)"
                - box-shadow: 0 8px 16px rgba(249, 115, 22, 0.4)
                - transform: scale(1.05)
        styles:
          card:
            - background: "linear-gradient(135deg, #475569 0%, #334155 100%)"
            - border-radius: 20px
            - transition: all 0.3s ease
          name:
            - color: white
            - font-weight: bold
            - font-size: 13px
          icon:
            - color: white
            - width: 32px
      - type: custom:button-card
        entity: media_player.ampli
        name: THX Select2 Cinema
        icon: mdi:movie-open-star
        tap_action:
          action: call-service
          service: pioneer_avr_lx83.send_raw_command
          service_data:
            entity_id: media_player.ampli
            command: 0054SR
        state:
          - operator: template
            value: |
              [[[
                var code = states['media_player.ampli'].attributes.sound_mode_code;
                return code === '0054';
              ]]]
            styles:
              card:
                - background: "linear-gradient(135deg, #be123c 0%, #9f1239 100%)"
                - box-shadow: 0 8px 16px rgba(190, 18, 60, 0.4)
                - transform: scale(1.05)
        styles:
          card:
            - background: "linear-gradient(135deg, #475569 0%, #334155 100%)"
            - border-radius: 20px
            - transition: all 0.3s ease
          name:
            - color: white
            - font-weight: bold
            - font-size: 11px
          icon:
            - color: white
            - width: 32px
      - type: custom:button-card
        entity: media_player.ampli
        name: THX Select2 Music
        icon: mdi:music-note-eighth
        tap_action:
          action: call-service
          service: pioneer_avr_lx83.send_raw_command
          service_data:
            entity_id: media_player.ampli
            command: 0055SR
        state:
          - operator: template
            value: |
              [[[
                var code = states['media_player.ampli'].attributes.sound_mode_code;
                return code === '0055';
              ]]]
            styles:
              card:
                - background: "linear-gradient(135deg, #c026d3 0%, #a21caf 100%)"
                - box-shadow: 0 8px 16px rgba(192, 38, 211, 0.4)
                - transform: scale(1.05)
        styles:
          card:
            - background: "linear-gradient(135deg, #475569 0%, #334155 100%)"
            - border-radius: 20px
            - transition: all 0.3s ease
          name:
            - color: white
            - font-weight: bold
            - font-size: 11px
          icon:
            - color: white
            - width: 32px
      - type: custom:button-card
        entity: media_player.ampli
        name: THX Select2 Games
        icon: mdi:gamepad-circle
        tap_action:
          action: call-service
          service: pioneer_avr_lx83.send_raw_command
          service_data:
            entity_id: media_player.ampli
            command: 0056SR
        state:
          - operator: template
            value: |
              [[[
                var code = states['media_player.ampli'].attributes.sound_mode_code;
                return code === '0056';
              ]]]
            styles:
              card:
                - background: "linear-gradient(135deg, #f97316 0%, #ea580c 100%)"
                - box-shadow: 0 8px 16px rgba(249, 115, 22, 0.4)
                - transform: scale(1.05)
        styles:
          card:
            - background: "linear-gradient(135deg, #475569 0%, #334155 100%)"
            - border-radius: 20px
            - transition: all 0.3s ease
          name:
            - color: white
            - font-weight: bold
            - font-size: 11px
          icon:
            - color: white
            - width: 32px
      - type: custom:button-card
        entity: media_player.ampli
        name: THX Surround EX
        icon: mdi:surround-sound-7-1
        tap_action:
          action: call-service
          service: pioneer_avr_lx83.send_raw_command
          service_data:
            entity_id: media_player.ampli
            command: 0115SR
        state:
          - operator: template
            value: |
              [[[
                var code = states['media_player.ampli'].attributes.sound_mode_code;
                return code === '0115';
              ]]]
            styles:
              card:
                - background: "linear-gradient(135deg, #dc2626 0%, #b91c1c 100%)"
                - box-shadow: 0 8px 16px rgba(220, 38, 38, 0.4)
                - transform: scale(1.05)
        styles:
          card:
            - background: "linear-gradient(135deg, #475569 0%, #334155 100%)"
            - border-radius: 20px
            - transition: all 0.3s ease
          name:
            - color: white
            - font-weight: bold
            - font-size: 12px
          icon:
            - color: white
            - width: 32px
  - type: custom:mushroom-title-card
    title: ðŸ“Š Ã‰tat actuel
  - type: grid
    columns: 2
    square: false
    cards:
      - type: custom:mushroom-template-card
        primary: Alimentation
        secondary: |
          {% if is_state('media_player.ampli', 'on') %}
            â— AllumÃ©
          {% else %}
            â—‹ Ã‰teint
          {% endif %}
        icon: mdi:power
        icon_color: |
          {% if is_state('media_player.ampli', 'on') %}
            green
          {% else %}
            red
          {% endif %}
        card_mod:
          style: |
            ha-card {
              background: linear-gradient(135deg, #475569 0%, #334155 100%);
              border-radius: 16px;
            }
      - type: custom:mushroom-template-card
        primary: Source active
        secondary: "{{ state_attr('media_player.ampli', 'source') | default('Aucune') }}"
        icon: mdi:import
        icon_color: purple
        card_mod:
          style: |
            ha-card {
              background: linear-gradient(135deg, #475569 0%, #334155 100%);
              border-radius: 16px;
            }
      - type: custom:mushroom-template-card
        primary: Volume
        secondary: |
          {% if state_attr('media_player.ampli', 'is_volume_muted') %}
            ðŸ”‡ Muet
          {% elif state_attr('media_player.ampli', 'volume_level') != None %}
            {{ (state_attr('media_player.ampli', 'volume_level') * 100) | round }}%
          {% else %}
            N/A
          {% endif %}
        icon: mdi:volume-high
        icon_color: blue
        card_mod:
          style: |
            ha-card {
              background: linear-gradient(135deg, #475569 0%, #334155 100%);
              border-radius: 16px;
            }
      - type: custom:mushroom-template-card
        primary: Mode audio
        secondary: "{{ state_attr('media_player.ampli', 'sound_mode') | default('N/A') }}"
        icon: mdi:surround-sound
        icon_color: cyan
        card_mod:
          style: |
            ha-card {
              background: linear-gradient(135deg, #475569 0%, #334155 100%);
              border-radius: 16px;
            }
      - type: custom:mushroom-template-card
        primary: Code du mode
        secondary: >-
          {{ state_attr('media_player.ampli', 'sound_mode_code') |
          default('N/A') }}
        icon: mdi:code-json
        icon_color: amber
        card_mod:
          style: |
            ha-card {
              background: linear-gradient(135deg, #475569 0%, #334155 100%);
              border-radius: 16px;
            }
      - type: custom:mushroom-template-card
        primary: DerniÃ¨re rÃ©ponse
        secondary: >-
          {{ state_attr('media_player.ampli', 'last_response') |
          default('Aucune') }}
        icon: mdi:reply
        icon_color: green
        card_mod:
          style: |
            ha-card {
              background: linear-gradient(135deg, #475569 0%, #334155 100%);
              border-radius: 16px;
            }
