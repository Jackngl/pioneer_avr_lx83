# Pioneer AVR LX83 Integration for Home Assistant

[![hacs_badge](https://img.shields.io/badge/HACS-Custom-orange.svg)](https://github.com/custom-components/hacs)
[![GitHub release](https://img.shields.io/github/release/Jackngl/pioneer_avr_lx83.svg)](https://GitHub.com/Jackngl/pioneer_avr_lx83/releases/)
[![License](https://img.shields.io/github/license/Jackngl/pioneer_avr_lx83.svg)](LICENSE)

Custom Home Assistant integration for Pioneer AVR LX83 receivers using Telnet protocol.

## Features

- âœ… Power on/off control
- âœ… Volume control (set, up, down)
- âœ… Mute/unmute
- âœ… Source selection
- âœ… Real-time status updates
- âœ… Basic transport control (play/pause)
- âœ… Listening-mode selection + raw `send_raw_command` service
- âœ… Config flow UI configuration
- âœ… HACS compatible
- âœ… Uses DataUpdateCoordinator (HA 2025.12+ compliant)
- âœ… Automatic source discovery via Pioneer `?RGBxx` responses

### âš ï¸ Important Technical Note

**Command Delay**: The integration automatically adds a **100ms delay** between each Telnet command to prevent saturating the amplifier's network processor. This delay is critical for reliable communication and should not be reduced.

## Installation

### HACS (Recommended)

1. Open HACS in Home Assistant
2. Click on "Integrations"
3. Click the three dots in the top right corner
4. Select "Custom repositories"
5. Add `https://github.com/Jackngl/pioneer_avr_lx83` as repository
6. Select "Integration" as category
7. Click "Add"
8. Search for "Pioneer AVR LX83" and install

### Manual Installation

1. Copy the `custom_components/pioneer_avr_lx83` directory to your Home Assistant's `custom_components` directory
2. Restart Home Assistant

## Configuration

1. Go to Settings > Devices & Services
2. Click "+ Add Integration"
3. Search for "Pioneer AVR LX83"
4. Enter your device's IP address, port (default: 23), and a name
5. Click "Submit"

Once configured, the integration creates **one entity** under the `media_player` domain. This entity can be used in your automations, scripts, and dashboards.

### How to find the exact name of your entity

**Important** : You need to know the exact name of your entity to use it in automations. Here's how to find it:

1. **Method 1 - Via the interface** :
   - Go to **Settings > Devices & Services**
   - Click on your **Pioneer AVR LX83** integration
   - Click on the listed entity (you'll see a `media_player` entity)
   - The full entity name is displayed at the top (e.g., `media_player.pioneer_avr` or `media_player.living_room_amp`)

2. **Method 2 - Via the developer tools** :
   - Go to **Settings > Devices & Services**
   - Click on **ENTITIES** at the top
   - Search for "Pioneer" or the name you gave
   - The entity ID is displayed (e.g., `media_player.pioneer_avr`)

3. **Method 3 - Via logs** :
   - Go to **Settings > System > Logs**
   - Search for integration messages at startup

**Note** : The entity name is automatically generated by Home Assistant from the name you gave during configuration. Spaces are replaced by underscores and everything is lowercase. For example, if you named your device "Living Room Amp", the entity will likely be `media_player.living_room_amp`.

## Supported Sources

- Analog: Phono, CD, Tuner, CDR/Tape, Video 1/2, Multi CH IN
- Digital: DVD, TV/SAT, DVR/BDR, iPod/USB, XM Radio, NET/HMG
- HDMI inputs 1 â†’ 5 (plus HDMI Cycle)
- BD / Blu-ray
- Adapter / Bluetooth port

> Tip: the integration automatically queries `?RGBxx` when the AVR is on. Any labels configured on the receiver are merged in addition to the built-in list above.

## Automations

The Pioneer AVR LX83 integration can be used in Home Assistant automations to automate control of your amplifier.

**âš ï¸ Important** : In all examples below, replace `media_player.pioneer_avr` with the exact name of your entity (see "How to find the exact name of your entity" section above).

Here are some practical examples:

### Example 1: Turn on amplifier when playing music

This automation turns on the amplifier and selects the appropriate source when you start playing music:

```yaml
alias: "Turn on amplifier for music"
description: "Turns on amplifier when music starts"
trigger:
  - platform: state
    entity_id: media_player.spotify  # Replace with your music player
    to: 'playing'
condition: []
action:
  - service: media_player.turn_on
    target:
      entity_id: media_player.pioneer_avr  # âš ï¸ REPLACE with your exact entity name
  - delay:
      seconds: 2  # Wait 2 seconds for amplifier to turn on
  - service: media_player.select_source
    target:
      entity_id: media_player.pioneer_avr
    data:
      source: "NET"  # Or "iPod/USB" depending on your source
  - service: media_player.set_volume_level
    target:
      entity_id: media_player.pioneer_avr
    data:
      volume_level: 0.3  # Volume at 30%
mode: single
```

### Example 2: Automatic power off

Turn off the amplifier after a period of inactivity or at a specific time:

```yaml
alias: "Turn off amplifier in evening"
description: "Turns off amplifier at 11:00 PM if on"
trigger:
  - platform: time
    at: "23:00:00"  # 11:00 PM
condition:
  - condition: state
    entity_id: media_player.pioneer_avr  # âš ï¸ REPLACE with your exact entity name
    state: 'on'
action:
  - service: media_player.turn_off
    target:
      entity_id: media_player.pioneer_avr
mode: single
```

### Example 3: Adjust volume by time

Automatically reduce volume during quiet hours:

```yaml
alias: "Reduced volume at night"
description: "Reduces volume at 10:00 PM"
trigger:
  - platform: time
    at: "22:00:00"  # 10:00 PM
condition:
  - condition: state
    entity_id: media_player.pioneer_avr  # âš ï¸ REPLACE with your exact entity name
    state: 'on'
action:
  - service: media_player.set_volume_level
    target:
      entity_id: media_player.pioneer_avr
    data:
      volume_level: 0.15  # Reduced volume at 15%
mode: single
```

### Example 4: Change source based on TV activity

Automatically change amplifier source when TV turns on:

```yaml
alias: "TV source when TV turns on"
description: "Changes source to TV/Sat when TV turns on"
trigger:
  - platform: state
    entity_id: media_player.tv  # Replace with your TV
    to: 'on'
condition: []
action:
  - service: media_player.turn_on
    target:
      entity_id: media_player.pioneer_avr  # âš ï¸ REPLACE with your exact entity name
  - delay:
      seconds: 2
  - service: media_player.select_source
    target:
      entity_id: media_player.pioneer_avr
    data:
      source: "TV/Sat"
mode: single
```

### Example 5: Automatic mute

Activate mute mode during phone calls or important notifications:

```yaml
alias: "Mute during calls"
description: "Activates mute mode during phone calls"
trigger:
  - platform: state
    entity_id: sensor.phone_call_status  # Example sensor
    to: 'ringing'
condition:
  - condition: state
    entity_id: media_player.pioneer_avr  # âš ï¸ REPLACE with your exact entity name
    state: 'on'
action:
  - service: media_player.volume_mute
    target:
      entity_id: media_player.pioneer_avr
    data:
      is_volume_muted: true
mode: single
```

### Example 6: Script for "Cinema" scenario

Create a script that configures the amplifier for an optimal cinema experience:

```yaml
script:
  cinema_mode:
    alias: "Cinema Mode"
    sequence:
      - service: media_player.turn_on
        target:
          entity_id: media_player.pioneer_avr
      - delay: "00:00:02"
      - service: media_player.select_source
        target:
          entity_id: media_player.pioneer_avr
        data:
          source: "DVD"
      - service: media_player.set_volume_level
        target:
          entity_id: media_player.pioneer_avr
        data:
          volume_level: 0.4  # Volume at 40%
      - service: media_player.volume_mute
        target:
          entity_id: media_player.pioneer_avr
        data:
          is_volume_muted: false
```

### Available Services

The entity created under the `media_player` domain exposes the following services:

- `media_player.turn_on` : Turn on the amplifier
- `media_player.turn_off` : Turn off the amplifier
- `media_player.volume_up` : Increase volume
- `media_player.volume_down` : Decrease volume
- `media_player.set_volume_level` : Set volume level (0.0 to 1.0)
- `media_player.volume_mute` : Enable/disable mute mode
- `media_player.select_source` : Select input source

### Available States

You can use these states in your automation conditions:

- `state` : `on` or `off`
- `volume_level` : Volume level (0.0 to 1.0)
- `is_volume_muted` : `true` or `false`
- `source` : Currently selected source

## Lovelace Dashboard

You can create a custom dashboard with a virtual remote control to control your Pioneer amplifier. Here is a complete example:

### Example Virtual Remote Control

Create a new dashboard in Home Assistant and add this YAML configuration:

```yaml
type: vertical-stack
cards:
  # Main card with state and on/off control
  - type: media-control
    entity: media_player.pioneer_avr  # Replace with your entity
    
  # Volume control with buttons
  - type: horizontal-stack
    cards:
      - type: button
        name: Volume -
        icon: mdi:volume-minus
        tap_action:
          action: call-service
          service: media_player.volume_down
          target:
            entity_id: media_player.pioneer_avr
      - type: gauge
        entity: media_player.pioneer_avr
        attribute: volume_level
        min: 0
        max: 1
        severity:
          green: 0
          yellow: 0.5
          red: 0.8
        name: Volume
      - type: button
        name: Volume +
        icon: mdi:volume-plus
        tap_action:
          action: call-service
          service: media_player.volume_up
          target:
            entity_id: media_player.pioneer_avr

  # Mute button
  - type: button
    name: Mute
    icon: mdi:volume-mute
    tap_action:
      action: toggle
      service: media_player.volume_mute
      target:
        entity_id: media_player.pioneer_avr
    state:
      - value: 'on'
        styles:
          icon:
            - color: red
      - value: 'off'
        styles:
          icon:
            - color: grey

  # Source selector
  - type: entities
    title: Input Source
    entities:
      - entity: media_player.pioneer_avr
        name: Source
        secondary_info: last-changed

  # Quick source buttons
  - type: grid
    columns: 3
    square: false
    cards:
      - type: button
        name: CD
        icon: mdi:disc-player
        tap_action:
          action: call-service
          service: media_player.select_source
          target:
            entity_id: media_player.pioneer_avr
          data:
            source: CD
      - type: button
        name: DVD
        icon: mdi:disc
        tap_action:
          action: call-service
          service: media_player.select_source
          target:
            entity_id: media_player.pioneer_avr
          data:
            source: DVD
      - type: button
        name: TV/Sat
        icon: mdi:television
        tap_action:
          action: call-service
          service: media_player.select_source
          target:
            entity_id: media_player.pioneer_avr
          data:
            source: TV/Sat
      - type: button
        name: NET
        icon: mdi:network
        tap_action:
          action: call-service
          service: media_player.select_source
          target:
            entity_id: media_player.pioneer_avr
          data:
            source: NET
      - type: button
        name: iPod/USB
        icon: mdi:usb
        tap_action:
          action: call-service
          service: media_player.select_source
          target:
            entity_id: media_player.pioneer_avr
          data:
            source: iPod/USB
      - type: button
        name: Tuner
        icon: mdi:radio
        tap_action:
          action: call-service
          service: media_player.select_source
          target:
            entity_id: media_player.pioneer_avr
          data:
            source: Tuner

  # Device information
  - type: entities
    title: Amplifier Status
    entities:
      - entity: media_player.pioneer_avr
        name: State
      - type: attribute
        entity: media_player.pioneer_avr
        attribute: volume_level
        name: Volume
        unit_of_measurement: '%'
      - type: attribute
        entity: media_player.pioneer_avr
        attribute: source
        name: Current Source
      - type: attribute
        entity: media_player.pioneer_avr
        attribute: is_volume_muted
        name: Mute Mode
```

### Premium Mushroom Dashboard Example

> Requirements: Mushroom cards, button-card, and optionally card-mod for the gradient styles.

```yaml
type: vertical-stack
cards:
  - type: custom:mushroom-title-card
    title: Pioneer AVR
    subtitle: LX83 Dashboard

  - type: horizontal-stack
    cards:
      - type: custom:mushroom-entity-card
        entity: media_player.pioneer_avr
        name: Power
        icon: mdi:power
        tap_action:
          action: toggle
      - type: custom:mushroom-template-card
        primary: "{{ states('media_player.pioneer_avr') | title }}"
        secondary: "{{ state_attr('media_player.pioneer_avr','source') | default('No source') }}"
        icon: mdi:speaker
        icon_color: >
          {% if is_state('media_player.pioneer_avr','on') %}green{% else %}red{% endif %}

  - type: custom:mushroom-media-player-card
    entity: media_player.pioneer_avr
    show_volume_level: true
    volume_controls:
      - volume_mute
      - volume_set
      - volume_buttons

  - type: custom:mushroom-title-card
    title: ðŸŽµ Audio Inputs

  - type: grid
    columns: 5
    square: false
    cards:
      - type: custom:button-card
        name: CD
        icon: mdi:disc-player
        tap_action:
          action: call-service
          service: media_player.select_source
          data:
            entity_id: media_player.pioneer_avr
            source: CD
      - type: custom:button-card
        name: Tuner
        icon: mdi:radio
        tap_action:
          action: call-service
          service: media_player.select_source
          data:
            entity_id: media_player.pioneer_avr
            source: Tuner
      - type: custom:button-card
        name: Phono
        icon: mdi:album
        tap_action:
          action: call-service
          service: media_player.select_source
          data:
            entity_id: media_player.pioneer_avr
            source: Phono
      - type: custom:button-card
        name: iPod/USB
        icon: mdi:usb
        tap_action:
          action: call-service
          service: media_player.select_source
          data:
            entity_id: media_player.pioneer_avr
            source: iPod/USB
      - type: custom:button-card
        name: Bluetooth
        icon: mdi:bluetooth
        tap_action:
          action: call-service
          service: media_player.select_source
          data:
            entity_id: media_player.pioneer_avr
            source: Bluetooth

  - type: custom:mushroom-title-card
    title: ðŸ“º Video Inputs

  - type: grid
    columns: 3
    square: false
    cards:
      - type: custom:button-card
        name: DVD
        icon: mdi:disc
        tap_action:
          action: call-service
          service: media_player.select_source
          data:
            entity_id: media_player.pioneer_avr
            source: DVD
      - type: custom:button-card
        name: BD
        icon: mdi:disc
        tap_action:
          action: call-service
          service: media_player.select_source
          data:
            entity_id: media_player.pioneer_avr
            source: BD
      - type: custom:button-card
        name: TV/Sat
        icon: mdi:television
        tap_action:
          action: call-service
          service: media_player.select_source
          data:
            entity_id: media_player.pioneer_avr
            source: "TV/Sat"

  - type: custom:mushroom-title-card
    title: ðŸ“Š Status

  - type: grid
    columns: 2
    square: false
    cards:
      - type: custom:mushroom-template-card
        primary: Power
        secondary: "{{ 'On' if is_state('media_player.pioneer_avr','on') else 'Off' }}"
        icon: mdi:power
      - type: custom:mushroom-template-card
        primary: Volume
        secondary: >
          {% if state_attr('media_player.pioneer_avr','is_volume_muted') %}
            Muted
          {% else %}
            {{ ((state_attr('media_player.pioneer_avr','volume_level') | float(0)) * 100) | round }}%
          {% endif %}
        icon: mdi:volume-high
      - type: custom:mushroom-template-card
        primary: Source
        secondary: "{{ state_attr('media_player.pioneer_avr','source') | default('None') }}"
        icon: mdi:import
      - type: custom:mushroom-template-card
        primary: Playback
        secondary: "{{ states('media_player.pioneer_avr') }}"
        icon: mdi:play
```

### Fully Styled (Gradient) Dashboard

> Requires Mushroom cards, button-card, and card-mod (for the gradient/shadow styles).

```yaml
type: vertical-stack
cards:
  - type: custom:mushroom-title-card
    title: Pioneer AVR
    subtitle: Amplificateur Audio/VidÃ©o
  - type: horizontal-stack
    cards:
      - type: custom:mushroom-entity-card
        entity: media_player.pioneer_avr
        name: Alimentation
        icon: mdi:power
        tap_action:
          action: toggle
        hold_action:
          action: more-info
        card_mod:
          style: |
            ha-card {
              background: linear-gradient(135deg, #1e293b 0%, #334155 100%);
              border-radius: 20px;
              box-shadow: 0 8px 16px rgba(0,0,0,0.3);
            }
      - type: custom:mushroom-template-card
        primary: "{{ states('media_player.pioneer_avr') | title }}"
        secondary: "{{ state_attr('media_player.pioneer_avr', 'source') | default('Aucune source') }}"
        icon: mdi:speaker
        icon_color: >
          {% if is_state('media_player.pioneer_avr', 'on') %}
            green
          {% else %}
            red
          {% endif %}
        card_mod:
          style: |
            ha-card {
              background: linear-gradient(135deg, #1e293b 0%, #334155 100%);
              border-radius: 20px;
              box-shadow: 0 8px 16px rgba(0,0,0,0.3);
            }
  - type: custom:mushroom-media-player-card
    entity: media_player.pioneer_avr
    use_media_info: false
    use_media_artwork: false
    show_volume_level: true
    volume_controls:
      - volume_mute
      - volume_set
      - volume_buttons
    card_mod:
      style: |
        ha-card {
          background: linear-gradient(135deg, #1e293b 0%, #334155 100%);
          border-radius: 20px;
          box-shadow: 0 8px 16px rgba(0,0,0,0.3);
          padding: 16px;
        }
  - type: custom:mushroom-title-card
    title: "ðŸŽµ Sources Audio"
  - type: grid
    columns: 5
    square: false
    cards:
      - type: custom:button-card
        entity: media_player.pioneer_avr
        name: CD
        icon: mdi:disc-player
        tap_action:
          action: call-service
          service: media_player.select_source
          service_data:
            entity_id: media_player.pioneer_avr
            source: CD
        styles:
          card:
            - background: |
                [[[
                  if (states['media_player.pioneer_avr'].attributes.source === 'CD') {
                    return 'linear-gradient(135deg, #a855f7 0%, #ec4899 100%)';
                  }
                  return 'linear-gradient(135deg, #475569 0%, #334155 100%)';
                ]]]
            - border-radius: 20px
            - box-shadow: |
                [[[
                  if (states['media_player.pioneer_avr'].attributes.source === 'CD') {
                    return '0 8px 16px rgba(168, 85, 247, 0.4)';
                  }
                  return '0 4px 8px rgba(0,0,0,0.2)';
                ]]]
            - transition: all 0.3s ease
            - transform: |
                [[[
                  if (states['media_player.pioneer_avr'].attributes.source === 'CD') {
                    return 'scale(1.05)';
                  }
                  return 'scale(1)';
                ]]]
          name:
            - color: white
            - font-weight: bold
            - font-size: 14px
          icon:
            - color: white
            - width: 32px
      - type: custom:button-card
        entity: media_player.pioneer_avr
        name: Tuner
        icon: mdi:radio
        tap_action:
          action: call-service
          service: media_player.select_source
          service_data:
            entity_id: media_player.pioneer_avr
            source: Tuner
        styles:
          card:
            - background: |
                [[[
                  if (states['media_player.pioneer_avr'].attributes.source === 'Tuner') {
                    return 'linear-gradient(135deg, #eab308 0%, #f97316 100%)';
                  }
                  return 'linear-gradient(135deg, #475569 0%, #334155 100%)';
                ]]]
            - border-radius: 20px
            - box-shadow: |
                [[[
                  if (states['media_player.pioneer_avr'].attributes.source === 'Tuner') {
                    return '0 8px 16px rgba(234, 179, 8, 0.4)';
                  }
                  return '0 4px 8px rgba(0,0,0,0.2)';
                ]]]
            - transition: all 0.3s ease
            - transform: |
                [[[
                  if (states['media_player.pioneer_avr'].attributes.source === 'Tuner') {
                    return 'scale(1.05)';
                  }
                  return 'scale(1)';
                ]]]
          name:
            - color: white
            - font-weight: bold
            - font-size: 14px
          icon:
            - color: white
            - width: 32px
      - type: custom:button-card
        entity: media_player.pioneer_avr
        name: Phono
        icon: mdi:album
        tap_action:
          action: call-service
          service: media_player.select_source
          service_data:
            entity_id: media_player.pioneer_avr
            source: Phono
        styles:
          card:
            - background: |
                [[[
                  if (states['media_player.pioneer_avr'].attributes.source === 'Phono') {
                    return 'linear-gradient(135deg, #f43f5e 0%, #dc2626 100%)';
                  }
                  return 'linear-gradient(135deg, #475569 0%, #334155 100%)';
                ]]]
            - border-radius: 20px
            - box-shadow: |
                [[[
                  if (states['media_player.pioneer_avr'].attributes.source === 'Phono') {
                    return '0 8px 16px rgba(244, 63, 94, 0.4)';
                  }
                  return '0 4px 8px rgba(0,0,0,0.2)';
                ]]]
            - transition: all 0.3s ease
            - transform: |
                [[[
                  if (states['media_player.pioneer_avr'].attributes.source === 'Phono') {
                    return 'scale(1.05)';
                  }
                  return 'scale(1)';
                ]]]
          name:
            - color: white
            - font-weight: bold
            - font-size: 14px
          icon:
            - color: white
            - width: 32px
      - type: custom:button-card
        entity: media_player.pioneer_avr
        name: iPod/USB
        icon: mdi:usb
        tap_action:
          action: call-service
          service: media_player.select_source
          service_data:
            entity_id: media_player.pioneer_avr
            source: iPod/USB
        styles:
          card:
            - background: |
                [[[
                  if (states['media_player.pioneer_avr'].attributes.source === 'iPod/USB') {
                    return 'linear-gradient(135deg, #8b5cf6 0%, #a855f7 100%)';
                  }
                  return 'linear-gradient(135deg, #475569 0%, #334155 100%)';
                ]]]
            - border-radius: 20px
            - box-shadow: |
                [[[
                  if (states['media_player.pioneer_avr'].attributes.source === 'iPod/USB') {
                    return '0 8px 16px rgba(139, 92, 246, 0.4)';
                  }
                  return '0 4px 8px rgba(0,0,0,0.2)';
                ]]]
            - transition: all 0.3s ease
            - transform: |
                [[[
                  if (states['media_player.pioneer_avr'].attributes.source === 'iPod/USB') {
                    return 'scale(1.05)';
                  }
                  return 'scale(1)';
                ]]]
          name:
            - color: white
            - font-weight: bold
            - font-size: 14px
          icon:
            - color: white
            - width: 32px
      - type: custom:button-card
        entity: media_player.pioneer_avr
        name: Bluetooth
        icon: mdi:bluetooth
        tap_action:
          action: call-service
          service: media_player.select_source
          service_data:
            entity_id: media_player.pioneer_avr
            source: Bluetooth
        styles:
          card:
            - background: |
                [[[
                  if (states['media_player.pioneer_avr'].attributes.source === 'Bluetooth') {
                    return 'linear-gradient(135deg, #06b6d4 0%, #3b82f6 100%)';
                  }
                  return 'linear-gradient(135deg, #475569 0%, #334155 100%)';
                ]]]
            - border-radius: 20px
            - box-shadow: |
                [[[
                  if (states['media_player.pioneer_avr'].attributes.source === 'Bluetooth') {
                    return '0 8px 16px rgba(6, 182, 212, 0.4)';
                  }
                  return '0 4px 8px rgba(0,0,0,0.2)';
                ]]]
            - transition: all 0.3s ease
            - transform: |
                [[[
                  if (states['media_player.pioneer_avr'].attributes.source === 'Bluetooth') {
                    return 'scale(1.05)';
                  }
                  return 'scale(1)';
                ]]]
          name:
            - color: white
            - font-weight: bold
            - font-size: 14px
          icon:
            - color: white
            - width: 32px
  - type: custom:mushroom-title-card
    title: "ðŸ“º Sources VidÃ©o"
  - type: grid
    columns: 3
    square: false
    cards:
      - type: custom:button-card
        entity: media_player.pioneer_avr
        name: DVD
        icon: mdi:disc
        tap_action:
          action: call-service
          service: media_player.select_source
          service_data:
            entity_id: media_player.pioneer_avr
            source: DVD
        styles:
          card:
            - background: |
                [[[
                  if (states['media_player.pioneer_avr'].attributes.source === 'DVD') {
                    return 'linear-gradient(135deg, #3b82f6 0%, #06b6d4 100%)';
                  }
                  return 'linear-gradient(135deg, #475569 0%, #334155 100%)';
                ]]]
            - border-radius: 20px
            - box-shadow: |
                [[[
                  if (states['media_player.pioneer_avr'].attributes.source === 'DVD') {
                    return '0 8px 16px rgba(59, 130, 246, 0.4)';
                  }
                  return '0 4px 8px rgba(0,0,0,0.2)';
                ]]]
            - transition: all 0.3s ease
            - transform: |
                [[[
                  if (states['media_player.pioneer_avr'].attributes.source === 'DVD') {
                    return 'scale(1.05)';
                  }
                  return 'scale(1)';
                ]]]
          name:
            - color: white
            - font-weight: bold
            - font-size: 14px
          icon:
            - color: white
            - width: 32px
      - type: custom:button-card
        entity: media_player.pioneer_avr
        name: BD
        icon: mdi:disc
        tap_action:
          action: call-service
          service: media_player.select_source
          service_data:
            entity_id: media_player.pioneer_avr
            source: BD
        styles:
          card:
            - background: |
                [[[
                  if (states['media_player.pioneer_avr'].attributes.source === 'BD') {
                    return 'linear-gradient(135deg, #6366f1 0%, #3b82f6 100%)';
                  }
                  return 'linear-gradient(135deg, #475569 0%, #334155 100%)';
                ]]]
            - border-radius: 20px
            - box-shadow: |
                [[[
                  if (states['media_player.pioneer_avr'].attributes.source === 'BD') {
                    return '0 8px 16px rgba(99, 102, 241, 0.4)';
                  }
                  return '0 4px 8px rgba(0,0,0,0.2)';
                ]]]
            - transition: all 0.3s ease
            - transform: |
                [[[
                  if (states['media_player.pioneer_avr'].attributes.source === 'BD') {
                    return 'scale(1.05)';
                  }
                  return 'scale(1)';
                ]]]
          name:
            - color: white
            - font-weight: bold
            - font-size: 14px
          icon:
            - color: white
            - width: 32px
      - type: custom:button-card
        entity: media_player.pioneer_avr
        name: TV/Sat
        icon: mdi:television
        tap_action:
          action: call-service
          service: media_player.select_source
          service_data:
            entity_id: media_player.pioneer_avr
            source: TV/Sat
        styles:
          card:
            - background: |
                [[[
                  if (states['media_player.pioneer_avr'].attributes.source === 'TV/Sat') {
                    return 'linear-gradient(135deg, #f97316 0%, #dc2626 100%)';
                  }
                  return 'linear-gradient(135deg, #475569 0%, #334155 100%)';
                ]]]
            - border-radius: 20px
            - box-shadow: |
                [[[
                  if (states['media_player.pioneer_avr'].attributes.source === 'TV/Sat') {
                    return '0 8px 16px rgba(249, 115, 22, 0.4)';
                  }
                  return '0 4px 8px rgba(0,0,0,0.2)';
                ]]]
            - transition: all 0.3s ease
            - transform: |
                [[[
                  if (states['media_player.pioneer_avr'].attributes.source === 'TV/Sat') {
                    return 'scale(1.05)';
                  }
                  return 'scale(1)';
                ]]]
          name:
            - color: white
            - font-weight: bold
            - font-size: 14px
          icon:
            - color: white
            - width: 32px
  - type: custom:mushroom-title-card
    title: "ðŸ“Š Ã‰tat actuel"
  - type: grid
    columns: 2
    square: false
    cards:
      # Power / Source / Volume / Mode cards identical to example above
```

#### Detailed version with per-source styling

> Requires Mushroom cards, button-card and (optionally) card-mod.
> Replace `media_player.pioneer_avr` everywhere with your actual entity ID.

```yaml
type: vertical-stack
cards:
  - type: custom:mushroom-title-card
    title: Pioneer AVR
    subtitle: Amplificateur Audio/VidÃ©o
  - type: horizontal-stack
    cards:
      - type: custom:mushroom-entity-card
        entity: media_player.pioneer_avr
        name: Power
        icon: mdi:power
        tap_action:
          action: toggle
        hold_action:
          action: more-info
        card_mod:
          style: |
            ha-card {
              background: linear-gradient(135deg, #1e293b 0%, #334155 100%);
              border-radius: 20px;
              box-shadow: 0 8px 16px rgba(0,0,0,0.3);
            }
      - type: custom:mushroom-template-card
        primary: "{{ states('media_player.pioneer_avr') | title }}"
        secondary: "{{ state_attr('media_player.pioneer_avr', 'source') | default('No source') }}"
        icon: mdi:speaker
        icon_color: >
          {% if is_state('media_player.pioneer_avr', 'on') %}
            green
          {% else %}
            red
          {% endif %}
        card_mod:
          style: |
            ha-card {
              background: linear-gradient(135deg, #1e293b 0%, #334155 100%);
              border-radius: 20px;
              box-shadow: 0 8px 16px rgba(0,0,0,0.3);
            }
  - type: custom:mushroom-media-player-card
    entity: media_player.pioneer_avr
    use_media_info: false
    use_media_artwork: false
    show_volume_level: true
    volume_controls:
      - volume_mute
      - volume_set
      - volume_buttons
    card_mod:
      style: |
        ha-card {
          background: linear-gradient(135deg, #1e293b 0%, #334155 100%);
          border-radius: 20px;
          box-shadow: 0 8px 16px rgba(0,0,0,0.3);
          padding: 16px;
        }
  - type: custom:mushroom-title-card
    title: ðŸŽµ Audio Sources
  - type: grid
    columns: 5
    square: false
    cards:
      - type: custom:button-card
        entity: media_player.pioneer_avr
        name: CD
        icon: mdi:disc-player
        tap_action:
          action: call-service
          service: media_player.select_source
          service_data:
            entity_id: media_player.pioneer_avr
            source: CD
        styles:
          card:
            - background: |
                [[[
                  if (states['media_player.pioneer_avr'].attributes.source === 'CD') {
                    return 'linear-gradient(135deg, #a855f7 0%, #ec4899 100%)';
                  }
                  return 'linear-gradient(135deg, #475569 0%, #334155 100%)';
                ]]]
            - border-radius: 20px
            - box-shadow: |
                [[[
                  if (states['media_player.pioneer_avr'].attributes.source === 'CD') {
                    return '0 8px 16px rgba(168, 85, 247, 0.4)';
                  }
                  return '0 4px 8px rgba(0,0,0,0.2)';
                ]]]
            - transition: all 0.3s ease
            - transform: |
                [[[
                  if (states['media_player.pioneer_avr'].attributes.source === 'CD') {
                    return 'scale(1.05)';
                  }
                  return 'scale(1)';
                ]]]
          name:
            - color: white
            - font-weight: bold
            - font-size: 14px
          icon:
            - color: white
            - width: 32px
      - type: custom:button-card
        entity: media_player.pioneer_avr
        name: Tuner
        icon: mdi:radio
        tap_action:
          action: call-service
          service: media_player.select_source
          service_data:
            entity_id: media_player.pioneer_avr
            source: Tuner
        styles:
          card:
            - background: |
                [[[
                  if (states['media_player.pioneer_avr'].attributes.source === 'Tuner') {
                    return 'linear-gradient(135deg, #eab308 0%, #f97316 100%)';
                  }
                  return 'linear-gradient(135deg, #475569 0%, #334155 100%)';
                ]]]
            - border-radius: 20px
            - box-shadow: |
                [[[
                  if (states['media_player.pioneer_avr'].attributes.source === 'Tuner') {
                    return '0 8px 16px rgba(234, 179, 8, 0.4)';
                  }
                  return '0 4px 8px rgba(0,0,0,0.2)';
                ]]]
            - transition: all 0.3s ease
            - transform: |
                [[[
                  if (states['media_player.pioneer_avr'].attributes.source === 'Tuner') {
                    return 'scale(1.05)';
                  }
                  return 'scale(1)';
                ]]]
          name:
            - color: white
            - font-weight: bold
            - font-size: 14px
          icon:
            - color: white
            - width: 32px
      - type: custom:button-card
        entity: media_player.pioneer_avr
        name: Phono
        icon: mdi:album
        tap_action:
          action: call-service
          service: media_player.select_source
          service_data:
            entity_id: media_player.pioneer_avr
            source: Phono
        styles:
          card:
            - background: |
                [[[
                  if (states['media_player.pioneer_avr'].attributes.source === 'Phono') {
                    return 'linear-gradient(135deg, #f43f5e 0%, #dc2626 100%)';
                  }
                  return 'linear-gradient(135deg, #475569 0%, #334155 100%)';
                ]]]
            - border-radius: 20px
            - box-shadow: |
                [[[
                  if (states['media_player.pioneer_avr'].attributes.source === 'Phono') {
                    return '0 8px 16px rgba(244, 63, 94, 0.4)';
                  }
                  return '0 4px 8px rgba(0,0,0,0.2)';
                ]]]
            - transition: all 0.3s ease
            - transform: |
                [[[
                  if (states['media_player.pioneer_avr'].attributes.source === 'Phono') {
                    return 'scale(1.05)';
                  }
                  return 'scale(1)';
                ]]]
          name:
            - color: white
            - font-weight: bold
            - font-size: 14px
          icon:
            - color: white
            - width: 32px
      - type: custom:button-card
        entity: media_player.pioneer_avr
        name: iPod/USB
        icon: mdi:usb
        tap_action:
          action: call-service
          service: media_player.select_source
          service_data:
            entity_id: media_player.pioneer_avr
            source: iPod/USB
        styles:
          card:
            - background: |
                [[[
                  if (states['media_player.pioneer_avr'].attributes.source === 'iPod/USB') {
                    return 'linear-gradient(135deg, #8b5cf6 0%, #a855f7 100%)';
                  }
                  return 'linear-gradient(135deg, #475569 0%, #334155 100%)';
                ]]]
            - border-radius: 20px
            - box-shadow: |
                [[[
                  if (states['media_player.pioneer_avr'].attributes.source === 'iPod/USB') {
                    return '0 8px 16px rgba(139, 92, 246, 0.4)';
                  }
                  return '0 4px 8px rgba(0,0,0,0.2)';
                ]]]
            - transition: all 0.3s ease
            - transform: |
                [[[
                  if (states['media_player.pioneer_avr'].attributes.source === 'iPod/USB') {
                    return 'scale(1.05)';
                  }
                  return 'scale(1)';
                ]]]
          name:
            - color: white
            - font-weight: bold
            - font-size: 14px
          icon:
            - color: white
            - width: 32px
      - type: custom:button-card
        entity: media_player.pioneer_avr
        name: Bluetooth
        icon: mdi:bluetooth
        tap_action:
          action: call-service
          service: media_player.select_source
          service_data:
            entity_id: media_player.pioneer_avr
            source: Bluetooth
        styles:
          card:
            - background: |
                [[[
                  if (states['media_player.pioneer_avr'].attributes.source === 'Bluetooth') {
                    return 'linear-gradient(135deg, #06b6d4 0%, #3b82f6 100%)';
                  }
                  return 'linear-gradient(135deg, #475569 0%, #334155 100%)';
                ]]]
            - border-radius: 20px
            - box-shadow: |
                [[[
                  if (states['media_player.pioneer_avr'].attributes.source === 'Bluetooth') {
                    return '0 8px 16px rgba(6, 182, 212, 0.4)';
                  }
                  return '0 4px 8px rgba(0,0,0,0.2)';
                ]]]
            - transition: all 0.3s ease
            - transform: |
                [[[
                  if (states['media_player.pioneer_avr'].attributes.source === 'Bluetooth') {
                    return 'scale(1.05)';
                  }
                  return 'scale(1)';
                ]]]
          name:
            - color: white
            - font-weight: bold
            - font-size: 14px
          icon:
            - color: white
            - width: 32px
  - type: custom:mushroom-title-card
    title: ðŸ“º Video Sources
  - type: grid
    columns: 3
    square: false
    cards:
      - type: custom:button-card
        entity: media_player.pioneer_avr
        name: DVD
        icon: mdi:disc
        tap_action:
          action: call-service
          service: media_player.select_source
          service_data:
            entity_id: media_player.pioneer_avr
            source: DVD
        styles:
          card:
            - background: |
                [[[
                  if (states['media_player.pioneer_avr'].attributes.source === 'DVD') {
                    return 'linear-gradient(135deg, #3b82f6 0%, #06b6d4 100%)';
                  }
                  return 'linear-gradient(135deg, #475569 0%, #334155 100%)';
                ]]]
            - border-radius: 20px
            - box-shadow: |
                [[[
                  if (states['media_player.pioneer_avr'].attributes.source === 'DVD') {
                    return '0 8px 16px rgba(59, 130, 246, 0.4)';
                  }
                  return '0 4px 8px rgba(0,0,0,0.2)';
                ]]]
            - transition: all 0.3s ease
            - transform: |
                [[[
                  if (states['media_player.pioneer_avr'].attributes.source === 'DVD') {
                    return 'scale(1.05)';
                  }
                  return 'scale(1)';
                ]]]
          name:
            - color: white
            - font-weight: bold
            - font-size: 14px
          icon:
            - color: white
            - width: 32px
      - type: custom:button-card
        entity: media_player.pioneer_avr
        name: BD
        icon: mdi:disc
        tap_action:
          action: call-service
          service: media_player.select_source
          service_data:
            entity_id: media_player.pioneer_avr
            source: Blu-ray
        styles:
          card:
            - background: |
                [[[
                  if (states['media_player.pioneer_avr'].attributes.source === 'Blu-ray') {
                    return 'linear-gradient(135deg, #6366f1 0%, #3b82f6 100%)';
                  }
                  return 'linear-gradient(135deg, #475569 0%, #334155 100%)';
                ]]]
            - border-radius: 20px
            - box-shadow: |
                [[[
                  if (states['media_player.pioneer_avr'].attributes.source === 'Blu-ray') {
                    return '0 8px 16px rgba(99, 102, 241, 0.4)';
                  }
                  return '0 4px 8px rgba(0,0,0,0.2)';
                ]]]
            - transition: all 0.3s ease
            - transform: |
                [[[
                  if (states['media_player.pioneer_avr'].attributes.source === 'Blu-ray') {
                    return 'scale(1.05)';
                  }
                  return 'scale(1)';
                ]]]
          name:
            - color: white
            - font-weight: bold
            - font-size: 14px
          icon:
            - color: white
            - width: 32px
      - type: custom:button-card
        entity: media_player.pioneer_avr
        name: TV/Sat
        icon: mdi:television
        tap_action:
          action: call-service
          service: media_player.select_source
          service_data:
            entity_id: media_player.pioneer_avr
            source: TV/Sat
        styles:
          card:
            - background: |
                [[[
                  if (states['media_player.pioneer_avr'].attributes.source === 'TV/Sat') {
                    return 'linear-gradient(135deg, #f97316 0%, #dc2626 100%)';
                  }
                  return 'linear-gradient(135deg, #475569 0%, #334155 100%)';
                ]]]
            - border-radius: 20px
            - box-shadow: |
                [[[
                  if (states['media_player.pioneer_avr'].attributes.source === 'TV/Sat') {
                    return '0 8px 16px rgba(249, 115, 22, 0.4)';
                  }
                  return '0 4px 8px rgba(0,0,0,0.2)';
                ]]]
            - transition: all 0.3s ease
            - transform: |
                [[[
                  if (states['media_player.pioneer_avr'].attributes.source === 'TV/Sat') {
                    return 'scale(1.05)';
                  }
                  return 'scale(1)';
                ]]]
          name:
            - color: white
            - font-weight: bold
            - font-size: 14px
          icon:
            - color: white
            - width: 32px
  - type: custom:mushroom-title-card
    title: ðŸŽš Audio Modes
  - type: grid
    columns: 4
    square: false
    cards:
      - type: custom:button-card
        entity: media_player.pioneer_avr
        name: Auto
        icon: mdi:surround-sound
        tap_action:
          action: call-service
          service: media_player.select_sound_mode
          service_data:
            entity_id: media_player.pioneer_avr
            sound_mode: "Auto Surround"
        styles:
          card:
            - background: |
                [[[
                  if (state_attr('media_player.pioneer_avr','sound_mode') === 'Auto Surround') {
                    return 'linear-gradient(135deg, #14b8a6 0%, #0ea5e9 100%)';
                  }
                  return 'linear-gradient(135deg, #475569 0%, #334155 100%)';
                ]]]
            - border-radius: 20px
            - box-shadow: |
                [[[
                  if (state_attr('media_player.pioneer_avr','sound_mode') === 'Auto Surround') {
                    return '0 8px 16px rgba(20, 184, 166, 0.4)';
                  }
                  return '0 4px 8px rgba(0,0,0,0.2)';
                ]]]
            - transition: all 0.3s ease
            - transform: |
                [[[
                  if (state_attr('media_player.pioneer_avr','sound_mode') === 'Auto Surround') {
                    return 'scale(1.05)';
                  }
                  return 'scale(1)';
                ]]]
          name:
            - color: white
            - font-weight: bold
            - font-size: 14px
          icon:
            - color: white
            - width: 32px
      - type: custom:button-card
        entity: media_player.pioneer_avr
        name: Direct
        icon: mdi:tune
        tap_action:
          action: call-service
          service: media_player.select_sound_mode
          service_data:
            entity_id: media_player.pioneer_avr
            sound_mode: Direct
        styles:
          card:
            - background: |
                [[[
                  if (state_attr('media_player.pioneer_avr','sound_mode') === 'Direct') {
                    return 'linear-gradient(135deg, #a855f7 0%, #6366f1 100%)';
                  }
                  return 'linear-gradient(135deg, #475569 0%, #334155 100%)';
                ]]]
            - border-radius: 20px
            - box-shadow: |
                [[[
                  if (state_attr('media_player.pioneer_avr','sound_mode') === 'Direct') {
                    return '0 8px 16px rgba(99, 102, 241, 0.4)';
                  }
                  return '0 4px 8px rgba(0,0,0,0.2)';
                ]]]
            - transition: all 0.3s ease
            - transform: |
                [[[
                  if (state_attr('media_player.pioneer_avr','sound_mode') === 'Direct') {
                    return 'scale(1.05)';
                  }
                  return 'scale(1)';
                ]]]
          name:
            - color: white
            - font-weight: bold
            - font-size: 14px
          icon:
            - color: white
            - width: 32px
      - type: custom:button-card
        entity: media_player.pioneer_avr
        name: Pure Direct
        icon: mdi:waveform
        tap_action:
          action: call-service
          service: media_player.select_sound_mode
          service_data:
            entity_id: media_player.pioneer_avr
            sound_mode: "Pure Direct"
        styles:
          card:
            - background: |
                [[[
                  if (state_attr('media_player.pioneer_avr','sound_mode') === 'Pure Direct') {
                    return 'linear-gradient(135deg, #f43f5e 0%, #ef4444 100%)';
                  }
                  return 'linear-gradient(135deg, #475569 0%, #334155 100%)';
                ]]]
            - border-radius: 20px
            - box-shadow: |
                [[[
                  if (state_attr('media_player.pioneer_avr','sound_mode') === 'Pure Direct') {
                    return '0 8px 16px rgba(239, 68, 68, 0.4)';
                  }
                  return '0 4px 8px rgba(0,0,0,0.2)';
                ]]]
            - transition: all 0.3s ease
            - transform: |
                [[[
                  if (state_attr('media_player.pioneer_avr','sound_mode') === 'Pure Direct') {
                    return 'scale(1.05)';
                  }
                  return 'scale(1)';
                ]]]
          name:
            - color: white
            - font-weight: bold
            - font-size: 14px
          icon:
            - color: white
            - width: 32px
      - type: custom:button-card
        entity: media_player.pioneer_avr
        name: Stereo
        icon: mdi:headphones
        tap_action:
          action: call-service
          service: media_player.select_sound_mode
          service_data:
            entity_id: media_player.pioneer_avr
            sound_mode: Stereo
        styles:
          card:
            - background: |
                [[[
                  if (state_attr('media_player.pioneer_avr','sound_mode') === 'Stereo') {
                    return 'linear-gradient(135deg, #0ea5e9 0%, #2563eb 100%)';
                  }
                  return 'linear-gradient(135deg, #475569 0%, #334155 100%)';
                ]]]
            - border-radius: 20px
            - box-shadow: |
                [[[
                  if (state_attr('media_player.pioneer_avr','sound_mode') === 'Stereo') {
                    return '0 8px 16px rgba(14, 165, 233, 0.4)';
                  }
                  return '0 4px 8px rgba(0,0,0,0.2)';
                ]]]
            - transition: all 0.3s ease
            - transform: |
                [[[
                  if (state_attr('media_player.pioneer_avr','sound_mode') === 'Stereo') {
                    return 'scale(1.05)';
                  }
                  return 'scale(1)';
                ]]]
          name:
            - color: white
            - font-weight: bold
            - font-size: 14px
          icon:
            - color: white
            - width: 32px
      - type: custom:button-card
        entity: media_player.pioneer_avr
        name: Extended
        icon: mdi:speaker-multiple
        tap_action:
          action: call-service
          service: media_player.select_sound_mode
          service_data:
            entity_id: media_player.pioneer_avr
            sound_mode: "Extended Stereo"
        styles:
          card:
            - background: |
                [[[
                  if (state_attr('media_player.pioneer_avr','sound_mode') === 'Extended Stereo') {
                    return 'linear-gradient(135deg, #d946ef 0%, #9333ea 100%)';
                  }
                  return 'linear-gradient(135deg, #475569 0%, #334155 100%)';
                ]]]
            - border-radius: 20px
            - box-shadow: |
                [[[
                  if (state_attr('media_player.pioneer_avr','sound_mode') === 'Extended Stereo') {
                    return '0 8px 16px rgba(217, 70, 239, 0.4)';
                  }
                  return '0 4px 8px rgba(0,0,0,0.2)';
                ]]]
            - transition: all 0.3s ease
            - transform: |
                [[[
                  if (state_attr('media_player.pioneer_avr','sound_mode') === 'Extended Stereo') {
                    return 'scale(1.05)';
                  }
                  return 'scale(1)';
                ]]]
          name:
            - color: white
            - font-weight: bold
            - font-size: 14px
          icon:
            - color: white
            - width: 32px
      - type: custom:button-card
        entity: media_player.pioneer_avr
        name: Game
        icon: mdi:gamepad-variant
        tap_action:
          action: call-service
          service: media_player.select_sound_mode
          service_data:
            entity_id: media_player.pioneer_avr
            sound_mode: "Advanced Game"
        styles:
          card:
            - background: |
                [[[
                  if (state_attr('media_player.pioneer_avr','sound_mode') === 'Advanced Game') {
                    return 'linear-gradient(135deg, #f97316 0%, #facc15 100%)';
                  }
                  return 'linear-gradient(135deg, #475569 0%, #334155 100%)';
                ]]]
            - border-radius: 20px
            - box-shadow: |
                [[[
                  if (state_attr('media_player.pioneer_avr','sound_mode') === 'Advanced Game') {
                    return '0 8px 16px rgba(249, 115, 22, 0.4)';
                  }
                  return '0 4px 8px rgba(0,0,0,0.2)';
                ]]]
            - transition: all 0.3s ease
            - transform: |
                [[[
                  if (state_attr('media_player.pioneer_avr','sound_mode') === 'Advanced Game') {
                    return 'scale(1.05)';
                  }
                  return 'scale(1)';
                ]]]
          name:
            - color: white
            - font-weight: bold
            - font-size: 14px
          icon:
            - color: white
            - width: 32px
      - type: custom:button-card
        entity: media_player.pioneer_avr
        name: THX
        icon: mdi:surround-sound-71
        tap_action:
          action: call-service
          service: media_player.select_sound_mode
          service_data:
            entity_id: media_player.pioneer_avr
            sound_mode: "THX Cinema"
        styles:
          card:
            - background: |
                [[[
                  if (state_attr('media_player.pioneer_avr','sound_mode') === 'THX Cinema') {
                    return 'linear-gradient(135deg, #22d3ee 0%, #0ea5e9 100%)';
                  }
                  return 'linear-gradient(135deg, #475569 0%, #334155 100%)';
                ]]]
            - border-radius: 20px
            - box-shadow: |
                [[[
                  if (state_attr('media_player.pioneer_avr','sound_mode') === 'THX Cinema') {
                    return '0 8px 16px rgba(34, 211, 238, 0.4)';
                  }
                  return '0 4px 8px rgba(0,0,0,0.2)';
                ]]]
            - transition: all 0.3s ease
            - transform: |
                [[[
                  if (state_attr('media_player.pioneer_avr','sound_mode') === 'THX Cinema') {
                    return 'scale(1.05)';
                  }
                  return 'scale(1)';
                ]]]
          name:
            - color: white
            - font-weight: bold
            - font-size: 14px
          icon:
            - color: white
            - width: 32px
      - type: custom:button-card
        entity: media_player.pioneer_avr
        name: Eco
        icon: mdi:leaf
        tap_action:
          action: call-service
          service: media_player.select_sound_mode
          service_data:
            entity_id: media_player.pioneer_avr
            sound_mode: "Eco Mode"
        styles:
          card:
            - background: |
                [[[
                  if (state_attr('media_player.pioneer_avr','sound_mode') === 'Eco Mode') {
                    return 'linear-gradient(135deg, #22c55e 0%, #16a34a 100%)';
                  }
                  return 'linear-gradient(135deg, #475569 0%, #334155 100%)';
                ]]]
            - border-radius: 20px
            - box-shadow: |
                [[[
                  if (state_attr('media_player.pioneer_avr','sound_mode') === 'Eco Mode') {
                    return '0 8px 16px rgba(34, 197, 94, 0.4)';
                  }
                  return '0 4px 8px rgba(0,0,0,0.2)';
                ]]]
            - transition: all 0.3s ease
            - transform: |
                [[[
                  if (state_attr('media_player.pioneer_avr','sound_mode') === 'Eco Mode') {
                    return 'scale(1.05)';
                  }
                  return 'scale(1)';
                ]]]
          name:
            - color: white
            - font-weight: bold
            - font-size: 14px
          icon:
            - color: white
            - width: 32px
  - type: custom:mushroom-title-card
    title: ðŸ“Š Current Status
  - type: grid
    columns: 2
    square: false
    cards:
      - type: custom:mushroom-template-card
        primary: Power
        secondary: >
          {% if is_state('media_player.pioneer_avr', 'on') %}
            â— On
          {% else %}
            â—‹ Off
          {% endif %}
        icon: mdi:power
        icon_color: >
          {% if is_state('media_player.pioneer_avr', 'on') %}
            green
          {% else %}
            red
          {% endif %}
        card_mod:
          style: |
            ha-card {
              background: linear-gradient(135deg, #475569 0%, #334155 100%);
              border-radius: 16px;
            }
      - type: custom:mushroom-template-card
        primary: Active Source
        secondary: "{{ state_attr('media_player.pioneer_avr', 'source') | default('None') }}"
        icon: mdi:import
        icon_color: purple
        card_mod:
          style: |
            ha-card {
              background: linear-gradient(135deg, #475569 0%, #334155 100%);
              border-radius: 16px;
            }
      - type: custom:mushroom-template-card
        primary: Volume
        secondary: >
          {% if state_attr('media_player.pioneer_avr', 'is_volume_muted') %}
            ðŸ”‡ Muted
          {% elif state_attr('media_player.pioneer_avr', 'volume_level') != None %}
            {{ ((state_attr('media_player.pioneer_avr', 'volume_level') | float(0)) * 100) | round }}%
          {% else %}
            N/A
          {% endif %}
        icon: mdi:volume-high
        icon_color: blue
        card_mod:
          style: |
            ha-card {
              background: linear-gradient(135deg, #475569 0%, #334155 100%);
              border-radius: 16px;
            }
      - type: custom:mushroom-template-card
        primary: Sound Mode
        secondary: "{{ state_attr('media_player.pioneer_avr', 'sound_mode') | default('Stereo') }}"
        icon: mdi:surround-sound
        icon_color: cyan
        card_mod:
          style: |
            ha-card {
              background: linear-gradient(135deg, #475569 0%, #334155 100%);
              border-radius: 16px;
            }
```

### Simplified Version with Compact Card

### Simplified Version with Compact Card

For a more compact remote control, here is a simplified version:

```yaml
type: vertical-stack
cards:
  # Main control card
  - type: media-control
    entity: media_player.pioneer_avr
    
  # Quick controls
  - type: grid
    columns: 4
    square: true
    cards:
      - type: button
        name: ON
        icon: mdi:power
        tap_action:
          action: call-service
          service: media_player.turn_on
          target:
            entity_id: media_player.pioneer_avr
      - type: button
        name: OFF
        icon: mdi:power-off
        tap_action:
          action: call-service
          service: media_player.turn_off
          target:
            entity_id: media_player.pioneer_avr
      - type: button
        name: Mute
        icon: mdi:volume-mute
        tap_action:
          action: toggle
          service: media_player.volume_mute
          target:
            entity_id: media_player.pioneer_avr
      - type: button
        name: Volume
        icon: mdi:volume-high
        tap_action:
          action: more-info
          entity: media_player.pioneer_avr

  # Compact source selector
  - type: button
    entity: media_player.pioneer_avr
    name: Source
    icon: mdi:input-hdmi
    tap_action:
      action: more-info
```

### Important Notes

- Replace `media_player.pioneer_avr` with the actual name of your entity (visible in Settings > Devices & Services)
- To find the exact name of your entity, go to Settings > Devices & Services, click on your Pioneer AVR LX83 integration, then on the entity
- Cards can be customized according to your preferences (colors, icons, layout)
- You can add these cards to an existing dashboard or create a new dedicated dashboard

## Telnet Commands

The integration uses the following Telnet commands:

| Command | Description |
|---------|-------------|
| `PO` | Power On |
| `PF` | Power Off |
| `?P` | Query Power State |
| `VLxxx` | Set Volume (000-185) |
| `?V` | Query Volume |
| `MO` | Mute On |
| `MF` | Mute Off |
| `?M` | Query Mute State |
| `FNxx` | Select Source |
| `?F` | Query Source |
| `?L` | Query Listening Mode |

### Quick Source Test Commands

Use a Telnet client (`telnet 192.168.1.26 23`) or the `pioneer_avr_lx83.send_raw_command` service to send the following shortcuts:

| Action | Command |
|--------|---------|
| Force CD input | `01FN` |
| Force DVD input | `04FN` |
| Force TV/Sat input | `05FN` |
| Force Blu-ray input | `25FN` |
| Force Bluetooth / Adapter Port | `33FN` |
| Force NET / Home Media Gallery | `26FN` |
| Force Phono | `00FN` |
| Query current input | `?F` (returns `FNxx`) |

### Listening Mode Commands

The most used listening modes can also be triggered manually:

#### Standard Modes

| Listening Mode | Command |
|----------------|---------|
| Stereo | `0001SR` |
| Auto Surround / Stream Direct | `0006SR` |
| Direct | `0007SR` |
| Pure Direct | `0008SR` |
| Standard (Dolby/DTS) | `0010SR` |
| Extended Stereo | `0112SR` |
| Advanced Game | `0118SR` |
| Optimum Surround | `0152SR` |
| Eco Mode | `0200SR` |

#### THX Modes

| Listening Mode | Command |
|----------------|---------|
| THX Cinema | `0101SR` |
| THX Music | `0102SR` |
| THX Games | `0103SR` |
| THX Select2 Cinema / Ultra2 Cinema | `0105SR` |
| THX Select2 Music / Ultra2 Music | `0106SR` |
| THX Select2 Games / Ultra2 Games | `0107SR` |
| THX Surround EX | `0115SR` |

#### Dolby Modes

| Listening Mode | Command |
|----------------|---------|
| PRO LOGIC II Movie | `0013SR` |
| PRO LOGIC II Music | `0014SR` |
| Dolby Surround (Atmos/LX models) | `0151SR` |

> Tip: In dashboards you can call `media_player.select_sound_mode` with the same labels (e.g. `"Auto Surround"`). For one-off troubleshooting or dashboards that need raw commands, call the service `pioneer_avr_lx83.send_raw_command` with `{"entity_id": "media_player.pioneer_avr", "command": "0006SR"}`.

## Testing and Verification

### How to test your integration

Once the integration is configured, here's how to test that everything works correctly:

#### 1. Verify the entity is created

1. Go to **Settings > Devices & Services**
2. Click on your **Pioneer AVR LX83** integration
3. You should see:
   - **1 device** (Pioneer AVR LX83)
   - **1 entity** (media_player)

If you don't see the entity:

- Check the logs (Settings > System > Logs)
- Restart Home Assistant
- Verify that the integration is properly configured (status "Configured")

#### 2. Test services manually

You can test each feature via the developer interface:

1. Go to **Settings > Devices & Services > Developer Tools**
2. Click on the **SERVICES** tab
3. Test the following services:

**Test 1 - Turn on amplifier** :

```yaml
Service: media_player.turn_on
Entity: media_player.pioneer_avr  # Replace with your entity
```

**Test 2 - Turn off amplifier** :

```yaml
Service: media_player.turn_off
Entity: media_player.pioneer_avr
```

**Test 3 - Set volume** :

```yaml
Service: media_player.set_volume_level
Entity: media_player.pioneer_avr
Service Data:
  volume_level: 0.3
```

**Test 4 - Activate mute** :

```yaml
Service: media_player.volume_mute
Entity: media_player.pioneer_avr
Service Data:
  is_volume_muted: true
```

**Test 5 - Change source** :

```yaml
Service: media_player.select_source
Entity: media_player.pioneer_avr
Service Data:
  source: CD
```

#### 3. Check entity state

1. Go to **Settings > Devices & Services > Developer Tools**
2. Click on the **STATES** tab
3. Search for your entity (e.g., `media_player.pioneer_avr`)
4. Check the attributes:
   - `state` : should be `on` or `off`
   - `volume_level` : should be between 0.0 and 1.0
   - `is_volume_muted` : should be `true` or `false`
   - `source` : should display the current source
   - `available` : should be `true` if device is connected

#### 4. Test with a simple script

Create a test script in **Settings > Automations & Scenes > Scripts** :

```yaml
test_pioneer:
  alias: "Test Pioneer AVR"
  sequence:
    - service: media_player.turn_on
      target:
        entity_id: media_player.pioneer_avr  # Replace with your entity
    - delay: "00:00:03"
    - service: media_player.set_volume_level
      target:
        entity_id: media_player.pioneer_avr
      data:
        volume_level: 0.2
    - delay: "00:00:02"
    - service: media_player.select_source
      target:
        entity_id: media_player.pioneer_avr
      data:
        source: CD
    - delay: "00:00:02"
    - service: media_player.volume_mute
      target:
        entity_id: media_player.pioneer_avr
      data:
        is_volume_muted: true
    - delay: "00:00:02"
    - service: media_player.volume_mute
      target:
        entity_id: media_player.pioneer_avr
      data:
        is_volume_muted: false
    - delay: "00:00:02"
    - service: media_player.turn_off
      target:
        entity_id: media_player.pioneer_avr
```

Run this script and verify that each action works on your amplifier.

#### 5. Check logs

If something doesn't work, check the logs:

1. Go to **Settings > System > Logs**
2. Search for messages containing "pioneer" or "avr"
3. Errors will be displayed with the `pioneer_avr_lx83` prefix

### Common issues

#### Entity doesn't appear

- **Solution 1** : Verify that the integration is properly configured and enabled
- **Solution 2** : Restart Home Assistant
- **Solution 3** : Check logs for connection errors
- **Solution 4** : Delete and reconfigure the integration

#### Entity is "unavailable"

- Check network connection between Home Assistant and amplifier
- Verify that Telnet is enabled on the amplifier
- Verify that the IP address is correct
- Test Telnet connection manually from a terminal

#### Commands don't work

- Verify that the amplifier is turned on
- Check logs for errors
- Test each service individually via the developer interface
- Verify that you're using the correct entity name

## Troubleshooting

### Cannot connect to device

- Verify the IP address is correct
- Ensure Telnet is enabled on your Pioneer AVR
- Check that port 23 is not blocked by a firewall
- Verify the device is on the same network

### Device not responding

- Restart the Pioneer AVR
- Restart Home Assistant
- Check network connectivity

## Versioning & Releases

- The integration follows [Semantic Versioning](https://semver.org) and the current version is stored in the `VERSION` file as well as `manifest.json`.
- Run `./scripts/bump_version.py 1.1.0` (replace with the desired number) to update all version references and create a new changelog stub.
- Commit the changes, then tag the release with `git tag -a v1.1.0 -m "Release v1.1.0"` and push the tag (`git push --tags`).
- A GitHub Actions workflow (`.github/workflows/release.yml`) automatically publishes a GitHub release when a `v*` tag is pushed, ensuring HACS can download a human-readable version such as `1.1.0`.
- Another workflow (`release-drafter.yml`) keeps a draft release up-to-date on every push to `main`, so you can just review the generated notes and publish once the tag exists.

## Contributing

Contributions are welcome! Please feel free to submit a Pull Request.

## License

This project is licensed under the MIT License - see the [LICENSE](LICENSE) file for details.

## Credits

- Developed by Jack
- Listening-mode reference adapted from [aiopioneer](https://github.com/fgierlinger/aiopioneer) (Apache-2.0)

## Compatibility

- Home Assistant 2023.1.0 or higher
- Compatible with Home Assistant 2025.12 and 2026.01
- Uses modern best practices (DataUpdateCoordinator)

## Support

If you encounter any issues, please [open an issue](https://github.com/Jackngl/pioneer_avr_lx83/issues) on GitHub.
